# Project Tree Structure

- .dockerignore
- .eslintrc.json
- .gitignore
- Dockerfile
    ```
    /* Dockerfile */
# frontend/Dockerfile

FROM node:18

WORKDIR /app

# Copy package files first to leverage Docker caching
COPY package*.json ./

# Install dependencies
RUN npm install

# Environment variables for build-time and runtime
ARG NEXT_PUBLIC_API_URL
ARG NEXT_PUBLIC_GOOGLE_CLIENT_ID

ENV NEXT_PUBLIC_API_URL=${NEXT_PUBLIC_API_URL}
ENV NEXT_PUBLIC_GOOGLE_CLIENT_ID=${NEXT_PUBLIC_GOOGLE_CLIENT_ID}

# Copy the application code
COPY . .

# Build the application for production
RUN npm run build

# Document that the container uses port 3000
EXPOSE 3000

# Use production start command
#CMD ["npm", "start"]

# Use development 
CMD ["npm", "run", "dev"]
    ```
- README.md
    ```md
    /* README.md */
This is a [Next.js](https://nextjs.org) project bootstrapped with [`create-next-app`](https://github.com/vercel/next.js/tree/canary/packages/create-next-app).

## Getting Started

First, run the development server:

```bash
npm run dev
# or
yarn dev
# or
pnpm dev
# or
bun dev
```

Open [http://localhost:3000](http://localhost:3000) with your browser to see the result.

You can start editing the page by modifying `app/page.js`. The page auto-updates as you edit the file.

This project uses [`next/font`](https://nextjs.org/docs/app/building-your-application/optimizing/fonts) to automatically optimize and load [Geist](https://vercel.com/font), a new font family for Vercel.

## Learn More

To learn more about Next.js, take a look at the following resources:

- [Next.js Documentation](https://nextjs.org/docs) - learn about Next.js features and API.
- [Learn Next.js](https://nextjs.org/learn) - an interactive Next.js tutorial.

You can check out [the Next.js GitHub repository](https://github.com/vercel/next.js) - your feedback and contributions are welcome!

## Deploy on Vercel

The easiest way to deploy your Next.js app is to use the [Vercel Platform](https://vercel.com/new?utm_medium=default-template&filter=next.js&utm_source=create-next-app&utm_campaign=create-next-app-readme) from the creators of Next.js.

Check out our [Next.js deployment documentation](https://nextjs.org/docs/app/building-your-application/deploying) for more details.

    ```
- frontend_20250426-194617.md
    ```md
    /* frontend_20250426-194617.md */
# Project Tree Structure

- .dockerignore
- .eslintrc.json
- .gitignore
- Dockerfile
    ```
    /* Dockerfile */
# frontend/Dockerfile

FROM node:18

WORKDIR /app

# Copy package files first to leverage Docker caching
COPY package*.json ./

# Install dependencies
RUN npm install

# Environment variables for build-time and runtime
ARG NEXT_PUBLIC_API_URL
ARG NEXT_PUBLIC_GOOGLE_CLIENT_ID

ENV NEXT_PUBLIC_API_URL=${NEXT_PUBLIC_API_URL}
ENV NEXT_PUBLIC_GOOGLE_CLIENT_ID=${NEXT_PUBLIC_GOOGLE_CLIENT_ID}

# Copy the application code
COPY . .

# Build the application for production
RUN npm run build

# Document that the container uses port 3000
EXPOSE 3000

# Use production start command
#CMD ["npm", "start"]

# Use development 
CMD ["npm", "run", "dev"]
    ```
- README.md
    ```md
    /* README.md */
This is a [Next.js](https://nextjs.org) project bootstrapped with [`create-next-app`](https://github.com/vercel/next.js/tree/canary/packages/create-next-app).

## Getting Started

First, run the development server:

```bash
npm run dev
# or
yarn dev
# or
pnpm dev
# or
bun dev
```

Open [http://localhost:3000](http://localhost:3000) with your browser to see the result.

You can start editing the page by modifying `app/page.js`. The page auto-updates as you edit the file.

This project uses [`next/font`](https://nextjs.org/docs/app/building-your-application/optimizing/fonts) to automatically optimize and load [Geist](https://vercel.com/font), a new font family for Vercel.

## Learn More

To learn more about Next.js, take a look at the following resources:

- [Next.js Documentation](https://nextjs.org/docs) - learn about Next.js features and API.
- [Learn Next.js](https://nextjs.org/learn) - an interactive Next.js tutorial.

You can check out [the Next.js GitHub repository](https://github.com/vercel/next.js) - your feedback and contributions are welcome!

## Deploy on Vercel

The easiest way to deploy your Next.js app is to use the [Vercel Platform](https://vercel.com/new?utm_medium=default-template&filter=next.js&utm_source=create-next-app&utm_campaign=create-next-app-readme) from the creators of Next.js.

Check out our [Next.js deployment documentation](https://nextjs.org/docs/app/building-your-application/deploying) for more details.

    ```
- jsconfig.json
- next.config.mjs
- **node_modules/**
- package-lock.json
- package.json
- postcss.config.mjs
- **src/**
    - **app/**
        - **admin/**
            - page.js
                ```js
                /* src\app\admin\page.js */
/* frontend/src/app/admin/page.js */
'use client';

import { useEffect, useState } from 'react';
import { useRouter } from 'next/navigation';

export default function AdminPanel() {
    const [user, setUser] = useState(null);
    const [isAdmin, setIsAdmin] = useState(false);
    const [users, setUsers] = useState([]);
    const [error, setError] = useState(null);
    const [currentPage, setCurrentPage] = useState(1);
    const [totalUsers, setTotalUsers] = useState(0);
    const [loading, setLoading] = useState(false);
    const router = useRouter();
    const API_URL = process.env.NEXT_PUBLIC_API_URL;
    const usersPerPage = 10;

    useEffect(() => {
        // Fetch the current user data
        const fetchUser = async () => {
            try {
                const res = await fetch(`${API_URL}/me`, {
                    credentials: 'include',
                });
                if (res.ok) {
                    const data = await res.json();
                    setUser(data);
                    if (data.is_admin) {
                        setIsAdmin(true);
                        fetchUsers();
                    } else {
                        setError('You are not authorized to access this page.');
                    }
                } else {
                    setError('Please log in to access the admin panel.');
                }
            } catch (err) {
                console.error('Error fetching user:', err);
                setError('An error occurred while fetching user data.');
            }
        };
        fetchUser();
    }, []);

    const fetchUsers = async (page = currentPage) => {
        try {
            setLoading(true);
            const skip = (page - 1) * usersPerPage;
            const res = await fetch(`${API_URL}/admin/users?limit=${usersPerPage}&skip=${skip}`, {
                credentials: 'include',
            });
            if (res.ok) {
                const data = await res.json();
                setUsers(data.users);
                setTotalUsers(data.total);
            } else {
                throw new Error('Failed to fetch users.');
            }
        } catch (err) {
            console.error('Error fetching users:', err);
            setError('An error occurred while fetching users.');
        } finally {
            setLoading(false);
        }
    };

    const updateUserTime = async (userId) => {
        const amountStr = prompt('Enter amount in minutes to add (positive) or reduce (negative):');
        const amount = parseFloat(amountStr);
        if (isNaN(amount)) {
            alert('Invalid amount');
            return;
        }
        try {
            const res = await fetch(`${API_URL}/admin/users/${userId}/time`, {
                method: 'PUT',
                credentials: 'include',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ amount }),
            });
            if (res.ok) {
                const data = await res.json();
                alert(`User ${userId} new remaining time: ${Math.floor(data.new_remaining_time)} minutes`);
                fetchUsers(currentPage);
            } else {
                const errData = await res.json();
                alert(`Error: ${errData.detail || 'An error occurred'}`);
            }
        } catch (err) {
            console.error('Error updating user time:', err);
            alert('An error occurred while updating user time.');
        }
    };

    const viewUserFiles = (userId) => {
        router.push(`/admin/users/${userId}/files`);
    };

    const viewUserActivities = (userId) => {
        router.push(`/admin/users/${userId}/activities`);
    };

    const handlePageChange = (newPage) => {
        if (newPage < 1 || newPage > Math.ceil(totalUsers / usersPerPage)) return;
        setCurrentPage(newPage);
        fetchUsers(newPage);
    };

    if (error) {
        return <div className="text-red-500 p-4">{error}</div>;
    }

    if (!user || !isAdmin) {
        return <div className="p-4">Loading...</div>;
    }

    return (
        <div className="p-4">
            <h1 className="text-2xl font-bold mb-4">Admin Panel</h1>
            {loading ? (
                <p>Loading users...</p>
            ) : (
                <table className="table-auto w-full mb-4">
                    <thead>
                        <tr className="bg-gray-200">
                            <th className="px-4 py-2">ID</th>
                            <th className="px-4 py-2">Email</th>
                            <th className="px-4 py-2">Name</th>
                            <th className="px-4 py-2">Remaining Time</th>
                            <th className="px-4 py-2">Expiration Date</th>
                            <th className="px-4 py-2">Successful Jobs</th>
                            <th className="px-4 py-2">Unsuccessful Jobs</th>
                            <th className="px-4 py-2">Total Transcription Duration</th>
                            <th className="px-4 py-2">Last Login</th>
                            <th className="px-4 py-2">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {users.map((userItem) => (
                            <tr key={userItem.id} className="border-b">
                                <td className="px-4 py-2">{userItem.id}</td>
                                <td className="px-4 py-2">{userItem.email}</td>
                                <td className="px-4 py-2">{userItem.name}</td>
                                <td className="px-4 py-2">{Math.floor(userItem.remaining_time)} minutes</td>
                                <td className="px-4 py-2">
                                    {userItem.expiration_date
                                        ? new Date(userItem.expiration_date).toLocaleDateString()
                                        : 'N/A'}
                                </td>
                                <td className="px-4 py-2">{userItem.successful_jobs}</td>
                                <td className="px-4 py-2">{userItem.failed_jobs}</td>
                                <td className="px-4 py-2">{Math.floor(userItem.total_used_time)} minutes</td>
                                <td className="px-4 py-2">
                                    {userItem.last_login ? new Date(userItem.last_login).toLocaleString() : 'Never'}
                                </td>
                                <td className="px-4 py-2">
                                    <button
                                        onClick={() => viewUserFiles(userItem.id)}
                                        className="bg-blue-500 text-white px-2 py-1 rounded mr-2"
                                    >
                                        View Files
                                    </button>
                                    <button
                                        onClick={() => viewUserActivities(userItem.id)}
                                        className="bg-green-500 text-white px-2 py-1 rounded mr-2"
                                    >
                                        View Activities
                                    </button>
                                    <button
                                        onClick={() => updateUserTime(userItem.id)}
                                        className="bg-yellow-500 text-white px-2 py-1 rounded"
                                    >
                                        Update Time
                                    </button>
                                </td>
                            </tr>
                        ))}
                    </tbody>
                </table>
            )}

            <div className="flex justify-center items-center mt-6 space-x-4">
                <button
                    onClick={() => handlePageChange(currentPage - 1)}
                    disabled={currentPage === 1}
                    className={`py-2 px-4 rounded ${
                        currentPage === 1 ? 'bg-gray-300 cursor-not-allowed' : 'bg-blue-500 text-white'
                    }`}
                >
                    Previous
                </button>
                <span>
                    Page {currentPage} of {Math.ceil(totalUsers / usersPerPage)}
                </span>
                <button
                    onClick={() => handlePageChange(currentPage + 1)}
                    disabled={currentPage === Math.ceil(totalUsers / usersPerPage)}
                    className={`py-2 px-4 rounded ${
                        currentPage === Math.ceil(totalUsers / usersPerPage)
                            ? 'bg-gray-300 cursor-not-allowed'
                            : 'bg-blue-500 text-white'
                    }`}
                >
                    Next
                </button>
            </div>
        </div>
    );
}
                ```
            - **users/**
                - **[userId]/**
        - **contact/**
            - page.js
                ```js
                /* src\app\contact\page.js */
/* frontend/src/app/contact/page.js */

'use client';

import { FaTelegramPlane, FaWhatsapp } from 'react-icons/fa';
import { PhoneIcon } from '@heroicons/react/24/solid';
import { useContext } from 'react';
import LanguageContext from '../../context/LanguageContext';

export default function Contact() {
    const { locale } = useContext(LanguageContext);
    const isRTL = locale === 'fa'; // Adjust based on your locale setup

    // Contact Methods Data
    const contactMethods = [
        {
            id: 'phone_whatsapp_telegram',
            label: locale === 'fa' ? 'تماس:' : 'Contact:',
            identifier: '+989335622283',
            icons: [
                <PhoneIcon key="phone" className="h-6 w-6 text-green-500" />,
                <FaWhatsapp key="whatsapp" className="h-6 w-6 text-green-500" />,
                <FaTelegramPlane key="telegram" className="h-6 w-6 text-blue-500" />,
            ],
            links: [
                'tel:+989335622283',
                'https://wa.me/989335622293',
                'https://t.me/tootty_com',
            ],
            ariaLabels: ['Phone', 'WhatsApp', 'Telegram'],
        },
    ];

    return (
        <div className="max-w-2xl mx-auto p-4 mt-20">
            <h1 className="text-3xl font-bold mb-6 text-center">
                {locale === 'fa' ? 'تماس با ما' : 'Contact Us'}
            </h1>

            <div className="space-y-6">
                {contactMethods.map((method) => (
                    <div key={method.id} className="text-center mb-4">
                        <p className="text-center" dir="auto">
                            <span className="font-bold">{method.label}</span> {method.identifier}
                        </p>
                        <div className="flex justify-center space-x-4 mt-2">
                            {method.icons.map((icon, index) => (
                                <a
                                    key={index}
                                    href={method.links[index]}
                                    {...(method.links[index].startsWith('http')
                                        ? { target: '_blank', rel: 'noopener noreferrer' }
                                        : {})}
                                    aria-label={method.ariaLabels[index]}
                                    className="hover:scale-110 transition-transform"
                                >
                                    {icon}
                                </a>
                            ))}
                        </div>
                    </div>
                ))}
            </div>
        </div>
    );
}
                ```
        - **dashboard/**
            - page.js
                ```js
                /* src\app\dashboard\page.js */
/* frontend/src/app/dashboard/page.js */
'use client';

import { useEffect, useState, useContext } from 'react';
import { useRouter } from 'next/navigation';
import FileUpload from '../../components/FileUpload';
import useSSE from '../hooks/useSSE';
import { EyeIcon, EyeSlashIcon } from '@heroicons/react/24/solid';
import LanguageContext from '../../context/LanguageContext';
import Link from 'next/link';

export default function Home() {
    const [user, setUser] = useState(null);
    const [files, setFiles] = useState([]);
    const [currentPage, setCurrentPage] = useState(1);
    const [totalFiles, setTotalFiles] = useState(0);
    const [filesPerPage] = useState(10);
    const [loadingUser, setLoadingUser] = useState(true);
    const [loading, setLoading] = useState(false);
    const [expandedFiles, setExpandedFiles] = useState({});
    const { t } = useContext(LanguageContext);
    const router = useRouter();
    const API_URL = process.env.NEXT_PUBLIC_API_URL;

    useEffect(() => {
        const cachedUser = localStorage.getItem('tutty_user');
        if (cachedUser) {
            try {
                const parsed = JSON.parse(cachedUser);
                setUser(parsed);
                setLoadingUser(false);
            } catch (err) {
                console.warn('Corrupted user data in localStorage:', err);
            }
        }
        fetchUser();
    }, []);

    useEffect(() => {
        if (user) {
            fetchFiles(currentPage);
        }
    }, [user]);

    const { reconnect } = useSSE((data) => {
        setFiles((prevFiles) => {
            const fileExists = prevFiles.some((f) => f.id === data.file_id);
            if (fileExists) {
                return prevFiles.map((file) =>
                    file.id === data.file_id
                        ? { ...file, status: data.status, message: data.message }
                        : file
                );
            } else {
                fetchFiles(currentPage);
                return prevFiles;
            }
        });

        if (data.status === 'transcribed' || data.status === 'error') {
            fetchUser();
            fetchFiles(currentPage);
        }
    });

    async function fetchUser() {
        try {
            const res = await fetch(`${API_URL}/me`, { credentials: 'include' });
            if (res.ok) {
                const data = await res.json();
                setUser(data);
                localStorage.setItem('tutty_user', JSON.stringify(data));
            } else {
                setUser(null);
                localStorage.removeItem('tutty_user');
            }
        } catch (err) {
            console.error('Error fetching user:', err);
            setUser(null);
            localStorage.removeItem('tutty_user');
        } finally {
            setLoadingUser(false);
        }
    }

    async function fetchFiles(page = currentPage) {
        try {
            setLoading(true);
            const offset = (page - 1) * filesPerPage;
            const res = await fetch(
                `${API_URL}/files?limit=${filesPerPage}&offset=${offset}`,
                { credentials: 'include' }
            );
            if (res.ok) {
                const data = await res.json();
                setFiles(data.files);
                setTotalFiles(data.total);
            } else {
                setFiles([]);
            }
        } catch (err) {
            setFiles([]);
        } finally {
            setLoading(false);
        }
    }

    const handleDelete = async (fileId) => {
        try {
            const res = await fetch(`${API_URL}/files/${fileId}`, {
                method: 'DELETE',
                credentials: 'include',
            });
            if (res.ok) {
                fetchFiles(currentPage);
            }
        } catch (err) {
            // Silently handle error
        }
    };

    const handleDownload = (file) => {
        if (!file.transcription) return;
        const extension = file.output_format === 'srt' ? 'srt' : 'txt';
        const bom = '\uFEFF'; // UTF-8 Byte Order Mark
        const blob = new Blob([bom + file.transcription], { type: 'text/plain;charset=utf-8' });
        const link = document.createElement('a');
        link.download = `${file.filename}_transcription.${extension}`;
        link.href = window.URL.createObjectURL(blob);
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        window.URL.revokeObjectURL(link.href);
    };
    const handleCopy = async (transcription) => {
        if (!transcription) return;
        try {
            await navigator.clipboard.writeText(transcription);
            alert('Transcription copied to clipboard!');
        } catch (err) {
            alert('Failed to copy transcription.');
        }
    };

    const toggleTranscription = (fileId) => {
        setExpandedFiles((prev) => ({
            ...prev,
            [fileId]: !prev[fileId],
        }));
    };

    const totalPages = Math.ceil(totalFiles / filesPerPage);

    const handlePageChange = (newPage) => {
        if (newPage < 1 || newPage > totalPages) return;
        setCurrentPage(newPage);
        fetchFiles(newPage);
    };

    // ───────────────────────────────────────────────────────────────────
    // Show a short "Loading" if we haven't confirmed the user from either
    // localStorage or background fetch. If we got user from localStorage,
    // loadingUser is already false by now.
    // ───────────────────────────────────────────────────────────────────
    if (loadingUser) {
        return (
            <div className="p-4 text-center">
                <p className="text-xl font-semibold">Loading your dashboard...</p>
            </div>
        );
    }

    if (!user) {
        return (
            <div className="text-center mt-20">
                <h1 className="text-4xl font-extrabold mb-4">
                    Welcome to <span className="text-primary">Tootty</span>
                </h1>
                <p className="text-lg mb-8">
                    Transcribe your media files easily and quickly.
                </p>
                <a
                    href={`${API_URL}/login`}
                    className="bg-primary hover:bg-secondary text-white py-3 px-6 rounded-md text-lg font-medium"
                >
                    Login with Google
                </a>
            </div>
        );
    }

    // If we have a user, show the real dashboard:
    return (
        <div className="max-w-7xl mx-auto p-4">
            <div className="flex flex-col md:flex-row md:items-center md:justify-between">
                <div>
                    <h2 className="text-2xl font-bold mb-2">{t('dashboard')}</h2>
                    <div className="flex flex-col items-start gap-2">
                        <p className="text-lg">
                            <strong>{t('remaining_time')}</strong>{' '}
                            {Math.floor(user.remaining_time)} {t('minutes')}
                            {user.expiration_date && (
                                <span className="text-sm text-gray-500 ml-2">
                                    (Expires on {new Date(user.expiration_date).toLocaleDateString()})
                                </span>
                            )}
                        </p>
                        {user.remaining_time === 0 && (
                            <p className="text-red-500 text-sm">
                                {user.expiration_date && new Date(user.expiration_date) < new Date()
                                    ? t('time_expired') || 'Your transcription time has expired. Please buy more time.'
                                    : t('time_used_up') || 'You have used all your transcription time. Please buy more time.'}
                            </p>
                        )}
                        <Link
                            href="/purchase"
                            className="inline-flex items-center px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md transition-colors"
                        >
                            {t('buy_more_time')}
                        </Link>
                    </div>
                </div>
                {user.picture && (
                    <img
                        src={user.picture}
                        alt="Profile"
                        className="rounded-full w-16 h-16 mt-4 md:mt-0 object-cover"
                    />
                )}
            </div>

            <FileUpload onUploadComplete={() => fetchFiles(currentPage)} />

            {loading ? (
                <p className="mt-8">Loading files...</p>
            ) : files.length > 0 ? (
                <div>
                    <h2 className="text-xl md:text-2xl font-bold mt-8">
                        {t('your_files')}
                    </h2>
                    <ul className="mt-4 space-y-4">
                        {files.map((file) => (
                            <li
                                key={file.id}
                                className="border rounded-md p-4 flex flex-col space-y-4 bg-white shadow"
                            >
                                <div className="flex flex-col md:flex-row md:justify-between md:items-center w-full">
                                    <div className="mb-4 md:mb-0 md:w-1/2">
                                        <p className="font-medium break-all text-foreground">
                                            {file.filename}
                                        </p>
                                        <p className="text-sm text-gray-500">
                                            Uploaded: {new Date(file.upload_time).toLocaleString()}
                                        </p>
                                        <p
                                            className={`mt-2 ${
                                                file.status === 'transcribed'
                                                    ? 'text-green-600'
                                                    : file.status === 'error'
                                                    ? 'text-red-600'
                                                    : 'text-yellow-600'
                                            }`}
                                        >
                                            Status: {file.status}
                                        </p>
                                        {file.message && (
                                            <p className="text-sm text-gray-500">{file.message}</p>
                                        )}
                                    </div>
                                    <div className="md:w-1/2 md:flex md:justify-end md:items-center space-x-2">
                                        {file.transcription && (
                                            <>
                                                <button
                                                    onClick={() => handleDownload(file)}
                                                    className="bg-secondary hover:bg-primary text-white py-1 px-3 rounded-md transition-colors"
                                                >
                                                    Download
                                                </button>
                                                <button
                                                    onClick={() => handleCopy(file.transcription)}
                                                    className="bg-accent hover:bg-primary text-white py-1 px-3 rounded-md transition-colors"
                                                >
                                                    Copy
                                                </button>
                                            </>
                                        )}
                                        <button
                                            onClick={() => handleDelete(file.id)}
                                            className="bg-red-500 hover:bg-red-600 text-white py-1 px-3 rounded-md transition-colors"
                                        >
                                            Delete
                                        </button>
                                        {file.transcription && (
                                            <button
                                                onClick={() => toggleTranscription(file.id)}
                                                className="bg-gray-500 hover:bg-gray-600 text-white py-1 px-3 rounded-md flex items-center transition-colors"
                                            >
                                                {expandedFiles[file.id] ? (
                                                    <>
                                                        <EyeSlashIcon className="w-5 h-5 mr-1" />
                                                        Hide
                                                    </>
                                                ) : (
                                                    <>
                                                        <EyeIcon className="w-5 h-5 mr-1" />
                                                        View
                                                    </>
                                                )}
                                            </button>
                                        )}
                                    </div>
                                </div>
                                {file.transcription && (
                                    <div
                                        className={`transition-all duration-300 overflow-y-auto ${
                                            expandedFiles[file.id]
                                                ? 'max-h-96 opacity-100 mt-4'
                                                : 'max-h-0 opacity-0'
                                        } bg-gray-100 p-4 rounded-md`}
                                    >
                                        <h3 className="font-semibold mb-2">Transcription:</h3>
                                        <p className="whitespace-pre-wrap text-gray-800">
                                            {file.transcription}
                                        </p>
                                    </div>
                                )}
                            </li>
                        ))}
                    </ul>
                    {totalPages > 1 && (
                        <div className="flex justify-center items-center mt-6 space-x-4">
                            <button
                                onClick={() => handlePageChange(currentPage - 1)}
                                disabled={currentPage === 1}
                                className={`py-2 px-4 rounded-md ${
                                    currentPage === 1
                                        ? 'bg-gray-300 cursor-not-allowed'
                                        : 'bg-primary text-white hover:bg-secondary'
                                }`}
                            >
                                Previous
                            </button>
                            <span>
                                Page {currentPage} of {totalPages}
                            </span>
                            <button
                                onClick={() => handlePageChange(currentPage + 1)}
                                disabled={currentPage === totalPages}
                                className={`py-2 px-4 rounded-md ${
                                    currentPage === totalPages
                                        ? 'bg-gray-300 cursor-not-allowed'
                                        : 'bg-primary text-white hover:bg-secondary'
                                }`}
                            >
                                Next
                            </button>
                        </div>
                    )}
                </div>
            ) : (
                <p className="mt-8">You have not uploaded any files yet.</p>
            )}
        </div>
    );
}
                ```
        - globals.css
            ```css
            /* src\app\globals.css */
/* frontend/src/app/globals.css */

@tailwind base;
@tailwind components;
@tailwind utilities;

/* Import fonts */
@import '@fontsource/poppins';
@import '@fontsource/merriweather';
@import 'vazir-font/dist/font-face.css'; /* Import Vazir Farsi font */
/* Import Inter from Google Fonts. 
   You could also import in the <head> with a <link>, but let's do it here for convenience. */
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
  @import 'vazir-font/dist/font-face.css'; /* Keep if you still want Vazir Farsi support */

/* Body and html styling */
html {
  scroll-behavior: smooth;
}

body {
  @apply bg-background text-foreground font-sans;
  margin: 0;
  padding: 0;
  font-family: 'Inter', sans-serif; /* Force body to Inter */
}

/* For Farsi content, selectively apply .font-farsi if needed */
.font-farsi {
  font-family: 'Vazir', sans-serif;
}

.font-english {
  font-family: 'Poppins', sans-serif;
}
/* Minimal resets for images */
img {
  max-width: 100%;
  height: auto;
}

/* Utility classes for button states, focus rings, etc. */
button:focus {
  @apply outline-none ring-2 ring-offset-2 ring-accent;
}

:root {
  --background: #FFFFFF;
  --foreground: #000000;
  --primary: #008080; /* Parrot-inspired teal */
  --secondary: #FFD700; /* Gold */
  --accent: #FF4500;   /* Orange-red */
}

@media (prefers-color-scheme: dark) {
  :root {
    --background: #1F2937;
    --foreground: #F9FAFB;
  }
}

a {
  @apply text-secondary hover:text-accent;
}

button {
  @apply focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent;
}

            ```
        - **hooks/**
            - useSSE.js
                ```js
                /* src\app\hooks\useSSE.js */
// src/app/hooks/useSSE.js
import { useEffect, useRef } from 'react';

export default function useSSE(onMessage) {
    const eventSourceRef = useRef(null);
    const retryTimeoutRef = useRef(null);
    const isConnectingRef = useRef(false);

    useEffect(() => {
        const API_URL = process.env.NEXT_PUBLIC_API_URL;
        let retryCount = 0;
        const MAX_RETRIES = 3;
        const RETRY_DELAY = 10000;

        function connect() {
            if (isConnectingRef.current) {
                return;
            }

            if (eventSourceRef.current) {
                eventSourceRef.current.close();
            }

            try {
                isConnectingRef.current = true;
                const eventSource = new EventSource(`${API_URL}/sse`, { withCredentials: true });
                eventSourceRef.current = eventSource;

                eventSource.onmessage = (event) => {
                    try {
                        const data = JSON.parse(event.data);
                        onMessage(data);
                        retryCount = 0;
                    } catch (error) {
                        // Silently handle message parsing errors
                    }
                };

                eventSource.onopen = () => {
                    isConnectingRef.current = false;
                    retryCount = 0;
                };

                eventSource.onerror = () => {
                    // Silently close the connection
                    eventSource.close();
                    isConnectingRef.current = false;

                    // Only retry if we haven't exceeded MAX_RETRIES
                    if (retryCount < MAX_RETRIES) {
                        retryCount++;
                        const delay = RETRY_DELAY * retryCount;
                        
                        if (retryTimeoutRef.current) {
                            clearTimeout(retryTimeoutRef.current);
                        }
                        
                        retryTimeoutRef.current = setTimeout(() => {
                            connect();
                        }, delay);
                    }
                };

            } catch (error) {
                // Silently handle connection errors
                isConnectingRef.current = false;
            }
        }

        // Handle visibility change silently
        const handleVisibilityChange = () => {
            if (document.visibilityState === 'visible') {
                connect();
            }
        };

        // Handle online/offline status silently
        const handleOnline = () => {
            connect();
        };

        const handleOffline = () => {
            if (eventSourceRef.current) {
                eventSourceRef.current.close();
            }
        };

        // Add event listeners
        document.addEventListener('visibilitychange', handleVisibilityChange);
        window.addEventListener('online', handleOnline);
        window.addEventListener('offline', handleOffline);

        // Initial connection only if online
        if (navigator.onLine) {
            connect();
        }

        // Cleanup function
        return () => {
            document.removeEventListener('visibilitychange', handleVisibilityChange);
            window.removeEventListener('online', handleOnline);
            window.removeEventListener('offline', handleOffline);
            
            if (retryTimeoutRef.current) {
                clearTimeout(retryTimeoutRef.current);
            }
            
            if (eventSourceRef.current) {
                eventSourceRef.current.close();
            }
        };
    }, [onMessage]);

    // Return a function to manually reconnect if needed
    return {
        reconnect: () => {
            if (eventSourceRef.current) {
                eventSourceRef.current.close();
            }
            if (retryTimeoutRef.current) {
                clearTimeout(retryTimeoutRef.current);
            }
            isConnectingRef.current = false;
            // Will trigger useEffect and reconnect
            window.dispatchEvent(new Event('online'));
        }
    };
}
                ```
        - layout.js
            ```js
            /* src\app\layout.js */
/* frontend/src/app/layout.js */
import './globals.css';
import { LanguageProvider } from '../context/LanguageContext';
import AppLayout from '../components/AppLayout';
import { cookies } from 'next/headers';
import Script from 'next/script';
import { GA_TRACKING_ID } from '../lib/gtag'; // Google Analytics tracking ID

export const metadata = {
  metadataBase: new URL('https://tootty.com'),
  title: 'Tootty AI',
  description: 'Transcribe and convert your media files (audio, video) to text or subtitles seamlessly with Tootty. Supports multiple languages including Persian, English, French, and more.',
  keywords: ['تبدیل صوت به متن','زیرنویس اتوماتیک','پیاده سازی','transcription', 'subtitle generation', 'media transcription', 'audio to text', 'farsi subtitle', 'speech recognition', 'Tootty', 'automatic transcription'],
  icons: '/favicon.ico',
  openGraph: {
    title: 'TooTTy - Advanced Transcription and Subtitle Generation',
    description: 'Automatically transcribe and generate subtitles from your media files. Fast, accurate, and multi-lingual.',
    url: 'https://tootty.com',
    siteName: 'Tootty',
    images: [
      {
        url: '/images/og-image.jpg',
        width: 800,
        height: 600,
        alt: 'Tutty Logo',
      },
    ],
    locale: 'en_US',
    type: 'website',
  },
  twitter: {
    card: 'summary_large_image',
    title: 'Tootty - Transcription Service',
    description: 'Transcribe your media files easily with Tootty.',
    images: ['/images/og-image.jpg'],
  },
  alternates: {
    canonical: 'https://tootty.com/',
  },
  robots: {
    index: true,
    follow: true,
  },
};

export default async function RootLayout({ children }) {
  const cookieStore = await cookies();
  const localeCookie = cookieStore.get('locale');
  const locale = localeCookie?.value || 'fa';

  return (
    <html lang={locale === 'fa' ? 'fa' : 'en'} dir={locale === 'fa' ? 'rtl' : 'ltr'}>
      <head>
        <meta name="author" content="Tootty Team" />
        <meta name="robots" content="index,follow" />
        <Script src="https://accounts.google.com/gsi/client" strategy="beforeInteractive" />
        {/* Google Analytics Script */}
        <Script
          src={`https://www.googletagmanager.com/gtag/js?id=${GA_TRACKING_ID}`}
          strategy="afterInteractive"
        />

        {/* Initialize Google Analytics */}
        <Script id="google-analytics" strategy="afterInteractive">
          {`
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', '${GA_TRACKING_ID}', {
              page_path: window.location.pathname,
            });
          `}
        </Script>
      </head>
      <body className="flex flex-col min-h-screen">
        <LanguageProvider initialLocale={locale}>
          <AppLayout>
            {/* MAIN CONTENT */}
            {children}
          </AppLayout>
        </LanguageProvider>
      </body>
    </html>
  );
}

            ```
        - page.js
            ```js
            /* src\app\page.js */
/* frontend/src/app/page.js */
'use client';

import { useEffect, useState, useContext } from 'react';
import { useRouter } from 'next/navigation';
import Image from 'next/image';
import LanguageContext from '../context/LanguageContext';
import GoogleSignInButton from '@/components/GoogleSignInButton';

export default function Home() {
    const [user, setUser] = useState(null);
    const router = useRouter();
    const API_URL = process.env.NEXT_PUBLIC_API_URL;
    const { t } = useContext(LanguageContext);

    useEffect(() => {
        fetchUser();
    }, []);

    const fetchUser = async () => {
        try {
            const res = await fetch(`${API_URL}/me`, {
                credentials: 'include',
            });
            if (res.ok) {
                const data = await res.json();
                setUser(data);
            } else {
                setUser(null);
            }
        } catch (err) {
            console.error('Error fetching user:', err);
        }
    };

    // Handler for login success
    const handleLoginSuccess = (userData) => {
        setUser(userData);
    };

    return (
        <div className="max-w-7xl mx-auto py-12 px-4">
            {/* Structured Data for SEO */}
            <script
                type="application/ld+json"
                dangerouslySetInnerHTML={{
                    __html: JSON.stringify({
                        "@context": "https://schema.org",
                        "@type": "WebSite",
                        name: "Tootty",
                        url: "https://tootty.com/",
                        description:
                            "Transcribe and convert media files (audio, video) automatically.",
                    }),
                }}
            />

            {/* Hero Section */}
            <section className="text-center mt-16 mb-20">
                <h1 className="text-4xl sm:text-5xl font-extrabold mb-4 text-primary">
                    {t('welcome_message')}
                </h1>
                <p className="text-xl text-gray-700 max-w-2xl mx-auto">
                    {t('transcribe_your_media')}
                </p>
            </section>

            {/* Features Section */}
            <section className="mt-10">
                <h2 className="text-3xl font-bold text-center mb-10 text-foreground">
                    {t('features')}
                </h2>
                <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div className="text-center p-6 rounded-lg bg-white shadow">
                        <Image
                            src="/images/feature1.svg"
                            alt="Accurate Transcriptions"
                            width={80}
                            height={80}
                            className="mx-auto mb-4"
                        />
                        <h3 className="text-lg font-semibold mb-2 text-foreground">
                            {t('accurate_transcribe')}
                        </h3>
                        <p className="text-gray-600">
                            {t('accurate_transcribe_text')}
                        </p>
                    </div>
                    <div className="text-center p-6 rounded-lg bg-white shadow">
                        <Image
                            src="/images/feature2.svg"
                            alt="Multiple Languages"
                            width={80}
                            height={80}
                            className="mx-auto mb-4"
                        />
                        <h3 className="text-lg font-semibold mb-2 text-foreground">
                            {t('multi_language')}
                        </h3>
                        <p className="text-gray-600">{t('multi_language_text')}</p>
                    </div>
                    <div className="text-center p-6 rounded-lg bg-white shadow">
                        <Image
                            src="/images/feature3.svg"
                            alt="Secure & Private"
                            width={80}
                            height={80}
                            className="mx-auto mb-4"
                        />
                        <h3 className="text-lg font-semibold mb-2 text-foreground">
                            {t('detect_speaker')}
                        </h3>
                        <p className="text-gray-600">{t('detect_speaker_text')}</p>
                    </div>
                </div>
            </section>

            {/* CTA Section */}
            <section className="text-center mt-16 mb-20">
                <h2 className="text-3xl font-bold text-primary mb-4">
                    {t('ready_to_get_started')}
                </h2>
                {!user && (
                    <p className="text-lg text-gray-700 mb-6">
                        {t('enjoy_seamless_transcription')}
                    </p>
                )}

                {/* Replace the “needs to be completed” part with the button below */}
                <GoogleSignInButton
                user={user}
                nextUrl="/dashboard"
                onLoginSuccess={handleLoginSuccess} // (optional) update local user state
                >
                    {t('start_here')}
                </GoogleSignInButton>
            </section>
        </div>
    );
}

            ```
        - **payment/**
            - **failed/**
                - page.js
                    ```js
                    /* src\app\payment\failed\page.js */
/* frontend/src/app/payment/failed/page.js */
"use client";

import { useEffect, useContext } from "react";
import { useRouter } from "next/navigation";
import LanguageContext from "../../../context/LanguageContext";

export default function PaymentFailedPage() {
    const router = useRouter();
    const { t } = useContext(LanguageContext);

    // Automatically redirect to /purchase after 5 seconds
    useEffect(() => {
        const timer = setTimeout(() => {
        router.push("/purchase");
        }, 5000);

        return () => clearTimeout(timer);
    }, [router]);

    return (
        <div className="max-w-2xl mx-auto p-6 text-center mt-20">
        <div className="bg-white rounded-lg shadow-md p-8">
            <div className="text-red-500 mb-4">
            <svg
                className="w-16 h-16 mx-auto"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
            >
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
            </svg>
            </div>
            <h1 className="text-2xl font-bold mb-4">{t("payment_failed")}</h1>
            <p className="text-gray-600 mb-4">{t("payment_failed_message")}</p>
            
            {/* Automatic redirect notice */}
            <p className="text-sm text-gray-500 mb-6">
            {t("redirecting_to_purchase_in_5_sec") ||
                "Redirecting to Purchase page in 5 seconds..."}
            </p>

            {/* Instant redirect button */}
            <button
            onClick={() => router.push("/purchase")}
            className="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-md"
            >
            {t("go_now") || "Go to Purchase Now"}
            </button>
        </div>
        </div>
    );
}

                    ```
            - **success/**
                - page.js
                    ```js
                    /* src\app\payment\success\page.js */
/* frontend/src/app/payment/success/page.js */
"use client";

import { useEffect, useContext } from "react";
import { useRouter } from "next/navigation";
import LanguageContext from "../../../context/LanguageContext";

export default function PaymentSuccessPage() {
    const router = useRouter();
    const { t } = useContext(LanguageContext);

    // Automatically redirect to /dashboard after 5 seconds
    useEffect(() => {
        const timer = setTimeout(() => {
        router.push("/dashboard");
        }, 5000);

        return () => clearTimeout(timer);
    }, [router]);

    return (
        <div className="max-w-2xl mx-auto p-6 text-center mt-20">
        <div className="bg-white rounded-lg shadow-md p-8">
            <div className="text-green-500 mb-4">
            <svg
                className="w-16 h-16 mx-auto"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
            >
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
            </svg>
            </div>
            <h1 className="text-2xl font-bold mb-4">{t("payment_successful")}</h1>
            <p className="text-gray-600 mb-4">{t("payment_success_message")}</p>
            
            {/* The automatic redirect notice */}
            <p className="text-sm text-gray-500 mb-6">
            {t("redirecting_to_dashboard_in_5_sec") ||
                "Redirecting to Dashboard in 5 seconds..."}
            </p>

            {/* Instant redirect button */}
            <button
            onClick={() => router.push("/dashboard")}
            className="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-md"
            >
            {t("go_now") || "Go to Dashboard Now"}
            </button>
        </div>
        </div>
    );
}

                    ```
        - **purchase/**
            - page.js
                ```js
                /* src\app\purchase\page.js */
"use client";

import { useState, useEffect, useContext } from "react";
import { useRouter } from "next/navigation";
import LanguageContext from "../../context/LanguageContext";

export default function PurchasePage() {
    const [hours, setHours] = useState(1);
    const [price, setPrice] = useState(0);
    const [loading, setLoading] = useState(false);
    const [error, setError] = useState(null);
    const router = useRouter();
    const { t, locale } = useContext(LanguageContext);
    const API_URL = process.env.NEXT_PUBLIC_API_URL;

    // Updated pricing function
    const calculatePrice = (hrs) => {
        if (hrs <= 4) {
            return hrs * 120000;
        } else if (hrs <= 9) {
            return hrs * 100000;
        } else {
            return hrs * 90000;
        }
    };

    function formatNumber(num, currentLocale) {
        const rawString = String(Math.round(num));
        let withCommas = rawString.replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        if (currentLocale === "fa") {
            const enToFa = {
                "0": "۰",
                "1": "۱",
                "2": "۲",
                "3": "۳",
                "4": "۴",
                "5": "۵",
                "6": "۶",
                "7": "۷",
                "8": "۸",
                "9": "۹",
            };
            withCommas = withCommas.replace(/[0-9]/g, (d) => enToFa[d]);
        }
        return withCommas;
    }

    useEffect(() => {
        setPrice(calculatePrice(hours));
    }, [hours]);

    const handleDecrement = () => {
        if (hours > 1) {
            setHours((prev) => prev - 1);
        }
    };

    const handleIncrement = () => {
        setHours((prev) => prev + 1);
    };

    const handleHoursChange = (e) => {
        const val = parseInt(e.target.value, 10);
        if (isNaN(val) || val < 1) {
            setHours(1);
        } else {
            setHours(val);
        }
    };

    const handlePurchase = async () => {
        try {
            setLoading(true);
            setError(null);
            const response = await fetch(`${API_URL}/payment/purchase`, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                credentials: "include",
                body: JSON.stringify({ hours: Number(hours) }),
            });
            const data = await response.json();
            if (!response.ok) {
                throw new Error(data.detail || "Failed to initiate payment");
            }
            if (data.success && data.payment_url) {
                window.location.href = data.payment_url;
            }
        } catch (err) {
            setError(err.message);
        } finally {
            setLoading(false);
        }
    };

    const finalPrice = Math.round(price * 1.1);
    const isPersian = locale === "fa";

    // Updated pricing plans
    const plans = [
        { key: "basic", price: 120000, hoursKey: "basic_plan_hours" },
        { key: "standard", price: 100000, hoursKey: "standard_plan_hours" },
        { key: "premium", price: 90000, hoursKey: "premium_plan_hours" },
    ];

    return (
        <div className={`max-w-4xl mx-auto px-4 py-8 ${isPersian ? "rtl" : ""}`}>
            {/* Hero / Intro Section */}
            <div className="text-center mb-10">
                <h1 className="text-3xl md:text-4xl font-bold text-primary mb-2">
                    {t("purchase_time")}
                </h1>
                <p className="text-gray-700">{t("enjoy_seamless_transcription")}</p>
            </div>

            {/* Pricing Information Cards */}
            <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                {plans.map((plan, index) => (
                    <div
                        key={plan.key}
                        className={`bg-white shadow-lg rounded-lg p-6 text-center transition-transform duration-300 hover:scale-105 ${
                            index === 1
                                ? "border-2 border-primary scale-105 relative overflow-hidden"
                                : ""
                        }`}
                    >
                        {index === 1 && (
                            <span className="absolute top-0 left-0 bg-primary text-white text-xs font-bold px-2 py-1 rounded-br-lg">
                                {t("most_popular") || "Most Popular"}
                            </span>
                        )}
                        <h2 className="text-xl font-semibold mb-2 text-foreground">
                            {t(`${plan.key}_plan`)}
                        </h2>
                        <p className="text-gray-500 mb-4">
                            {t(plan.hoursKey)}
                        </p>
                        <p className="text-sm text-gray-600 mb-2">
                            {locale === "fa" ? "در یک ماه" : "for a month"}
                        </p>
                        <p className="text-2xl font-bold text-gray-800 mb-4">
                            {formatNumber(plan.price, locale)}{" "}
                            <span className="text-sm">{t("toman_per_hour")}</span>
                        </p>
                        <p className="text-sm text-gray-500">
                            {locale === "fa" ? "بعلاوه 10% مالیات ارزش افزوده" : "plus 10% VAT"}
                        </p>
                    </div>
                ))}
            </div>

            {/* Contact Message */}
            <div className="text-center mb-8 text-gray-600">
                {locale === 'fa' ? (
                    <p>
                        مشاوره و خرید سازمانی{' '}
                        <a href="tel:09335622293" className="text-primary hover:underline">
                            09335622293
                        </a>
                    </p>
                ) : (
                    <p>
                        for more questions call or WhatsApp{' '}
                        <a href="tel:09335622293" className="text-primary hover:underline">
                            09335622293
                        </a>
                    </p>
                )}
            </div>

            {/* Hours Input with Stepper */}
            <div className="bg-white shadow-md rounded-lg p-6 mb-8">
                <h2 className="text-xl font-semibold mb-4 text-foreground">
                    {t("select_hours")}
                </h2>
                <div className="flex items-center space-x-3 max-w-xs">
                    <button
                        onClick={handleDecrement}
                        className="px-3 py-1 bg-gray-200 rounded text-2xl"
                    >
                        -
                    </button>
                    <input
                        type="number"
                        className="border border-gray-300 rounded-md w-24 p-2 text-center"
                        value={hours}
                        onChange={handleHoursChange}
                        min="1"
                        aria-label={t("select_hours")}
                    />
                    <button
                        onClick={handleIncrement}
                        className="px-3 py-1 bg-gray-200 rounded text-2xl"
                    >
                        +
                    </button>
                </div>
                <p className="text-sm text-gray-500 mt-2">
                    {t("type_any_hours") || "Enter any number of hours you need"}
                </p>
            </div>

            {/* Payment Summary Section */}
            <div className="bg-white shadow-md rounded-lg p-6 mb-8">
                <h2 className="text-xl font-semibold mb-4">{t("payment_summary")}</h2>
                <div className="flex justify-between mb-2">
                    <span className="text-lg">{t("total_price")}:</span>
                    <span className="text-lg font-semibold text-gray-800">
                        {formatNumber(price, locale)} {t("toman")}
                    </span>
                </div>
                <div className="flex justify-between mb-2">
                    <span className="text-lg">{t("final_price") || "Final Price"}:</span>
                    <span className="text-lg font-semibold text-gray-800">
                        {formatNumber(finalPrice, locale)} {t("toman")}
                    </span>
                </div>
                {error && (
                    <div className="mt-4 p-4 bg-red-100 text-red-700 rounded-md">
                        {error}
                    </div>
                )}
                <button
                    onClick={handlePurchase}
                    disabled={loading}
                    className={`mt-4 w-full md:w-auto inline-block py-3 px-6 rounded-md text-white font-semibold 
                        ${
                            loading
                                ? "bg-gray-400 cursor-not-allowed"
                                : "bg-primary hover:bg-secondary transition"
                        }`}
                >
                    {loading ? t("processing") : t("proceed_to_payment")}
                </button>
            </div>

            <div className="bg-gray-100 rounded-md p-4 text-sm text-gray-600">
                <p>
                    {t("disclaimer_text") ||
                        "Note: All prices subject to a 10% VAT. Payment is processed via Zarinpal gateway. If you have any questions, contact our support."}
                </p>
            </div>
        </div>
    );
}
                ```
        - sitemap.xml.js
            ```js
            /* src\app\sitemap.xml.js */
// frontend/src/app/sitemap.xml.js

import { NextResponse } from 'next/server';

export const dynamic = 'force-dynamic';

export async function GET() {
  // Normally you would fetch dynamic routes from your database
  // For demonstration, we assume a few static pages and dynamic routes.
    
    const baseUrl = 'https://tootty.com';
    
    // Static pages
    const pages = [
        '',
        'dashboard',
        'contact',
        'admin' // if admin panel is public or you want it indexed, otherwise omit
    ];
    
    // Construct sitemap entries
    const sitemapEntries = pages.map(page => `
        <url>
        <loc>${baseUrl}/${page}</loc>
        <lastmod>${new Date().toISOString()}</lastmod>
        <changefreq>weekly</changefreq>
        <priority>${page === '' ? '1.0' : '0.8'}</priority>
        </url>
    `).join('');

    const sitemap = `<?xml version="1.0" encoding="UTF-8"?>
    <urlset
        xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"
        xmlns:xhtml="http://www.w3.org/1999/xhtml"
    >
        ${sitemapEntries}
    </urlset>`;

    return new NextResponse(sitemap, {
        headers: {
        'Content-Type': 'application/xml',
        },
    });
}

            ```
    - **components/**
        - AppLayout.js
            ```js
            /* src\components\AppLayout.js */
/* frontend/src/components/AppLayout.js */

'use client';

import Navbar from './Navbar';
import Footer from './Footer';

export default function AppLayout({ children }) {
    return (
        <>
            <Navbar />
            <main className="flex-grow">{children}</main>
            <Footer />
        </>
    );
}

            ```
        - FileUpload.js
            ```js
            /* src\components\FileUpload.js */
/* frontend/src/components/FileUpload.js */

'use client';

import { useState, useContext } from 'react';
import LanguageContext from '../context/LanguageContext';
import Link from 'next/link';

export default function FileUpload({ onUploadComplete }) {
    const [file, setFile] = useState(null);
    const [message, setMessage] = useState('');
    const [uploading, setUploading] = useState(false);
    const API_URL = process.env.NEXT_PUBLIC_API_URL;
    const [outputFormat, setOutputFormat] = useState('txt');
    const [language, setLanguage] = useState('fa');
    const [diarize, setDiarize] = useState(false);
    const { t } = useContext(LanguageContext);

    const handleFileChange = (e) => {
        setFile(e.target.files[0]);
        setMessage('');
    };

    const handleSubmit = async (e) => {
        e.preventDefault();
        if (!file) {
            setMessage(t('please_select_a_file') || 'Please select a file');
            return;
        }

        setUploading(true);
        setMessage(t('uploading') || 'Uploading...');

        const formData = new FormData();
        formData.append('file', file);
        formData.append('output_format', outputFormat);
        formData.append('language', language);
        formData.append('tag_audio_events', 'false'); // Always set to false as per requirement
        formData.append('diarize', diarize.toString());

        try {
            const res = await fetch(`${API_URL}/upload`, {
                method: 'POST',
                credentials: 'include',
                body: formData,
            });

            setUploading(false);

            if (res.ok) {
                setMessage(t('upload_completed_transcription_in_progress') || 'Upload completed. Transcription in progress...');
                setFile(null);
                onUploadComplete && onUploadComplete();
            } else {
                const data = await res.json();
                if (data.detail === 'Insufficient transcription time. Please buy more time.') {
                    // Set message as a localized link to /purchase
                    setMessage(
                        <Link href="/purchase" className="text-primary underline">
                            {t('insufficient_transcription_time')}
                        </Link>
                    );
                } else {
                    setMessage(`${t('upload_failed') || 'Upload failed'}: ${data.detail || 'An error occurred'}`);
                }
            }
        } catch (err) {
            console.error('Error during upload:', err);
            setUploading(false);
            setMessage(`${t('upload_failed') || 'Upload failed'}: ${err.message || 'An error occurred'}`);
        }
    };

    return (
        <div className="p-4 bg-white border rounded-md mt-8 shadow-sm">
            <h2 className="text-xl md:text-2xl font-semibold mb-1 text-foreground">
                {t('upload_media') || 'Upload Media'}
            </h2>
            <p className="text-sm text-gray-500 mb-4">
                {t('media_file_limits') || 'Audio or video files with maximum 4 hours length and 250 MB size'}
            </p>
            <form onSubmit={handleSubmit} className="flex flex-col space-y-4">
                <input
                    type="file"
                    accept=".wav,.mp3,.mp4,.m4a,.flac,.aac,.ogg"
                    onChange={handleFileChange}
                    className="border p-2 rounded-md"
                    disabled={uploading}
                />
                
                <label className="flex flex-col text-foreground">
                    {t('language') || 'Language'}
                    <select
                        value={language}
                        onChange={(e) => setLanguage(e.target.value)}
                        className="border p-2 rounded-md mt-1"
                    >
                        <option value="fa">Persian</option>
                        <option value="en">English</option>
                        <option value="ar">Arabic</option>
                        <option value="tr">Turkish</option>
                        <option value="fr">French</option>
                        <option value="de">German</option>
                        <option value="ur">Urdu</option>
                        <option value="he">Hebrew</option>
                        <option value="es">Spanish</option>
                        <option value="pt">Portuguese</option>
                        <option value="ru">Russian</option>
                        <option value="cmn">Mandarin</option>
                        <option value="ja">Japanese</option>
                        <option value="hi">Hindi</option>
                        <option value="bn">Bengali</option>
                        <option value="id">Indonesian</option>
                        <option value="ko">Korean</option>
                        <option value="it">Italian</option>
                        <option value="nl">Dutch</option>
                        <option value="pl">Polish</option>
                        <option value="uk">Ukrainian</option>
                        <option value="ro">Romanian</option>
                        <option value="sv">Swedish</option>
                        <option value="el">Greek</option>
                        <option value="hu">Hungarian</option>
                        <option value="cs">Czech</option>
                        <option value="th">Thai</option>
                        <option value="ms">Malay</option>
                        <option value="vi">Vietnamese</option>
                        <option value="no">Norwegian</option>
                        <option value="fi">Finnish</option>
                        <option value="bg">Bulgarian</option>
                        <option value="sw">Swahili</option>
                        <option value="et">Estonian</option>
                        <option value="gl">Galician</option>
                        <option value="ga">Irish</option>
                        <option value="ug">Uyghur</option>
                    </select>
                </label>

                <label className="flex flex-col text-foreground">
                    {t('output_format') || 'Output Format'}
                    <select
                        value={outputFormat}
                        onChange={(e) => setOutputFormat(e.target.value)}
                        className="border p-2 rounded-md mt-1"
                    >
                        <option value="txt">Text (txt)</option>
                        <option value="srt">SubRip (srt)</option>
                        <option value="json">JSON</option>
                    </select>
                </label>

                <div className="flex flex-col space-y-2">
                    <label className="flex items-center space-x-2">
                        <input
                            type="checkbox"
                            checked={diarize}
                            onChange={(e) => setDiarize(e.target.checked)}
                            className="form-checkbox h-5 w-5 text-primary"
                        />
                        <span>{t('diarize') || 'Diarize (Speaker Identification)'}</span>
                    </label>
                </div>

                <button
                    type="submit"
                    className={`bg-primary text-white py-2 px-4 rounded-md ${
                        uploading ? 'opacity-50 cursor-not-allowed' : 'hover:bg-secondary'
                    }`}
                    disabled={uploading}
                >
                    {uploading ? (t('uploading') || 'Uploading...') : (t('upload') || 'Upload')}
                </button>
            </form>

            {message && (
                <p
                    className={`mt-4 ${
                        typeof message === 'object' ? 'text-red-600' : (
                            message.toLowerCase().includes('failed') ||
                            message.toLowerCase().includes('insufficient')
                                ? 'text-red-600'
                                : 'text-green-600'
                        )
                    }`}
                >
                    {message}
                </p>
            )}
        </div>
    );
}
            ```
        - Footer.js
            ```js
            /* src\components\Footer.js */
/* frontend\src\components\Footer.js */
import Link from 'next/link';
import Script from 'next/script';
import { useState, useEffect } from 'react';

export default function Footer() {
    // Whether we should load Enamad script at all
    const [loadEnamad, setLoadEnamad] = useState(false);
    // Whether the script actually finished loading
    const [enamadLoaded, setEnamadLoaded] = useState(false);

    useEffect(() => {
        // Lazy-load the Enamad script a few seconds after the component mounts
        const timer = setTimeout(() => {
        setLoadEnamad(true);
        }, 3000); // Adjust if needed
        return () => clearTimeout(timer);
    }, []);

    return (
        <footer className="bg-white border-t mt-8">
        <div className="max-w-7xl mx-auto py-6 px-4">
            {/* 
            We divide footer into three horizontal sections
            that stack into columns on small screens (md:flex-row).
            */}
            <div className="flex flex-col md:flex-row items-center">
            
            {/* 1) Left: Copyright & Powered by */}
            <div className="w-full md:w-1/3 flex justify-start items-center">
                <p className="text-sm text-gray-500">
                &copy; {new Date().getFullYear()}{' '}
                <span className="font-semibold text-primary">Tootty</span>.
                {' '}Powered by IRSDN.
                </p>
            </div>

            {/* 2) Center: Contact Link (make it bigger + centered) */}
            <div className="w-full md:w-1/3 flex justify-center my-4 md:my-0">
                <Link
                href="/contact"
                className="text-lg text-gray-600 hover:text-primary font-semibold"
                >
                Contact
                </Link>
            </div>

            {/* 3) Right: Enamad logo (lazy-loaded) */}
            <div className="w-full md:w-1/3 flex justify-end items-center">
                {loadEnamad ? (
                <div id="enamad-root">
                    <Script
                    id="enamad-script"
                    strategy="afterInteractive"
                    onLoad={() => setEnamadLoaded(true)}
                    onError={() => console.warn('Enamad script failed to load.')}
                    >
                    {`
                        var enamadHost = 'https://trustseal.enamad.ir';
                        var enamadParam = '?id=594666&Code=YY2Mg6gGdAGYLPpkfhWUk8xBU1Mqh29g';
                        document.getElementById('enamad-root').innerHTML = 
                        '<a target="_blank" href="' + enamadHost + enamadParam + '" ' +
                        'referrerPolicy="origin">' +
                        '<img src="' + enamadHost + '/logo.aspx' + enamadParam + '" ' +
                        'alt="نماد اعتماد الکترونیکی" style="cursor:pointer" ' +
                        'referrerPolicy="origin"/></a>';
                    `}
                    </Script>

                    {!enamadLoaded && (
                    <span className="text-xs text-gray-400">
                        Loading Enamad...
                    </span>
                    )}
                </div>
                ) : (
                <span className="text-xs text-gray-400">
                    Loading...
                </span>
                )}
            </div>

            </div>
        </div>
        </footer>
    );
}
            ```
        - GoogleSignInButton.js
            ```js
            /* src\components\GoogleSignInButton.js */
/* src/components/GoogleSignInButton.js */

/* 
    KEEPING PREVIOUS COMMENTS (EXAMPLE):
    Old approach was using "window.google.accounts.id" for a popup sign-in.
    This sometimes led to slow popups and AbortErrors if the user closed it.

    Now, we switch to a simpler redirect-based approach. We do not remove these 
    old comments, just comment out the old code so you can reference it later.
    */

    'use client';
    import { useRouter } from 'next/navigation';
    import { useEffect } from 'react';

    export default function GoogleSignInButton({
    children,
    // user,           // old approach used user
    nextUrl = '/dashboard',
    // onLoginSuccess, // old approach used onLoginSuccess
    }) {
    const router = useRouter();
    const API_URL = process.env.NEXT_PUBLIC_API_URL;

    // --------------------------------------------
    // Old popup-based approach (commented out)
    // --------------------------------------------
    /*
    useEffect(() => {
        if (typeof window !== 'undefined') {
        window.handleGoogleCredentialResponse = async (response) => {
            // ... old logic
        };
        if (window.google?.accounts?.id) {
            window.google.accounts.id.initialize({
            client_id: process.env.NEXT_PUBLIC_GOOGLE_CLIENT_ID,
            callback: (res) => window.handleGoogleCredentialResponse(res),
            });
            // setGoogleReady(true);
        }
        }
    }, [API_URL, nextUrl, onLoginSuccess, router]);
    
    const handleClickOld = async () => {
        if (user) {
        // if already logged in...
        router.push(nextUrl);
        } else {
        if (googleReady && window.google?.accounts?.id) {
            window.google.accounts.id.prompt();
        }
        }
    };
    */

    // --------------------------------------------
    // NEW: Redirect Flow
    // --------------------------------------------
    const handleClick = () => {
        // Simply redirect to /login/google (FastAPI route)
        // That route will redirect to Google’s OAuth page.
        window.location.href = `${API_URL}/login/google`;
    };

    return (
        <button
        onClick={handleClick}
        className="bg-primary text-white px-6 py-3 rounded-md font-semibold shadow hover:bg-secondary transition"
        >
        {children}
        </button>
    );
}

            ```
        - Navbar.js
            ```js
            /* src\components\Navbar.js */
/* frontend/src/components/Navbar.js */
'use client';
import Link from 'next/link';
import { useState, useEffect, useContext } from 'react';
import Image from 'next/image';
import LanguageContext from '../context/LanguageContext';
import GoogleSignInButton from './GoogleSignInButton';

export default function Navbar() {
  // State management for user data and mobile menu
    const [user, setUser] = useState(null);
    const [menuOpen, setMenuOpen] = useState(false);
    
    // Environment and context setup
    const API_URL = process.env.NEXT_PUBLIC_API_URL;
    const { locale, switchLanguage, t } = useContext(LanguageContext);

    // Helper function to check and update user state from localStorage
    const checkLocalStorage = () => {
        const cachedUser = localStorage.getItem('tutty_user');
        if (cachedUser) {
        try {
            const parsed = JSON.parse(cachedUser);
            setUser(parsed);
        } catch (err) {
            console.warn('Corrupted user data in localStorage:', err);
        }
        }
    };

    // Setup effect for user state management and event listeners
    useEffect(() => {
        // Initial state setup
        checkLocalStorage();
        fetchUser();
        
        // Event listener for login state changes
        const handleNavbarRefetch = () => {
        checkLocalStorage();
        fetchUser();
        };
        
        // Add event listener for cross-component communication
        window.addEventListener('navbarRefetch', handleNavbarRefetch);
        
        // Cleanup on component unmount
        return () => {
        window.removeEventListener('navbarRefetch', handleNavbarRefetch);
        };
    }, []);

    // Function to fetch latest user data from the server
    async function fetchUser() {
        try {
        const res = await fetch(`${API_URL}/me`, {
            credentials: 'include',
        });
        if (res.ok) {
            const data = await res.json();
            setUser(data);
            // Keep localStorage in sync with server data
            localStorage.setItem('tutty_user', JSON.stringify(data));
        } else {
            setUser(null);
            localStorage.removeItem('tutty_user');
        }
        } catch (err) {
        console.error('Error fetching user:', err);
        setUser(null);
        localStorage.removeItem('tutty_user');
        }
    }

    // Handle user logout process
    const handleLogout = async () => {
        try {
        const res = await fetch(`${API_URL}/logout`, {
            method: 'POST',
            credentials: 'include',
        });
        if (res.ok) {
            setUser(null);
            localStorage.removeItem('tutty_user');
            window.location.href = '/';
        } else {
            console.error('Logout failed:', res.statusText);
        }
        } catch (err) {
        console.error('Error logging out:', err);
        }
    };

    // Render user-specific content based on login state
    const renderUserActions = () => {
        if (user) {
        return (
            <>
            <span className="text-gray-700">
                {user.name ? user.name.split(' ')[0] : 'User'}
            </span>
            <button
                onClick={handleLogout}
                className="bg-primary hover:bg-secondary text-white px-3 py-2 rounded-md"
            >
                {t('logout') ?? 'Logout'}
            </button>
            </>
        );
        } else {
        return (
            <GoogleSignInButton
            user={user}
            onLoginSuccess={fetchUser}
            >
            {t('login') ?? 'Sign in by Google'}
            </GoogleSignInButton>
        );
        }
    };

    return (
        <nav className="bg-white border-b shadow-sm">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex justify-between items-center h-16">
            {/* Logo Section */}
            <Link href="/" className="flex items-center text-xl font-bold text-foreground">
            <Image
                src="/images/logo.png"
                alt="Tutty Logo"
                width={36}
                height={36}
                className="mr-2"
            />
            <span className="text-primary">Tootty</span>
            </Link>

            {/* Desktop Menu */}
            <div className="hidden md:flex items-center space-x-4">
            {/* Language Switcher */}
            <button
                onClick={() => switchLanguage('fa')}
                className={`px-3 py-2 rounded-md hover:bg-gray-100 transition ${
                locale === 'fa' ? 'bg-gray-100' : ''
                }`}
            >
                فارسی
            </button>
            <button
                onClick={() => switchLanguage('en')}
                className={`px-3 py-2 rounded-md hover:bg-gray-100 transition ${
                locale === 'en' ? 'bg-gray-100' : ''
                }`}
            >
                English
            </button>

            {/* Navigation Links for Logged-in Users */}
            {user && (
                <>
                <Link href="/dashboard" className="hover:text-primary transition px-3 py-2">
                    {t('dashboard') ?? 'Dashboard'}
                </Link>
                <Link href="/purchase" className="hover:text-primary transition px-3 py-2">
                    {locale === 'fa' ? 'خرید زمان' : 'Buy Time'}
                </Link>
                </>
            )}

            {/* Admin Panel Link */}
            {user?.is_admin && (
                <Link href="/admin" className="hover:text-primary transition px-3 py-2">
                {t('admin_panel') ?? 'Admin Panel'}
                </Link>
            )}
            </div>

            {/* Desktop User Actions */}
            <div className="hidden md:flex items-center space-x-4">
            {renderUserActions()}
            </div>

            {/* Mobile Menu Button */}
            <div className="md:hidden flex items-center">
            <button
                onClick={() => setMenuOpen(!menuOpen)}
                className="text-foreground focus:outline-none"
            >
                <svg className="w-6 h-6" fill="none" stroke="currentColor">
                {menuOpen ? (
                    <path
                    strokeLinecap="round"
                    strokeLinejoin="round"
                    strokeWidth={2}
                    d="M6 18L18 6M6 6l12 12"
                    />
                ) : (
                    <path
                    strokeLinecap="round"
                    strokeLinejoin="round"
                    strokeWidth={2}
                    d="M4 6h16M4 12h16M4 18h16"
                    />
                )}
                </svg>
            </button>
            </div>
        </div>

        {/* Mobile Menu Dropdown */}
        {menuOpen && (
            <div className="md:hidden bg-white border-t shadow-sm">
            <div className="px-2 pt-2 pb-3 space-y-1">
                {/* Language Switcher - Mobile */}
                <button
                onClick={() => switchLanguage('fa')}
                className={`block px-3 py-2 rounded-md ${
                    locale === 'fa' ? 'bg-gray-100' : ''
                }`}
                >
                فارسی
                </button>
                <button
                onClick={() => switchLanguage('en')}
                className={`block px-3 py-2 rounded-md ${
                    locale === 'en' ? 'bg-gray-100' : ''
                }`}
                >
                English
                </button>

                {/* Navigation Links - Mobile */}
                {user && (
                <>
                    <Link href="/dashboard" className="block px-3 py-2 rounded-md hover:bg-gray-100">
                    {t('dashboard') ?? 'Dashboard'}
                    </Link>
                    <Link href="/purchase" className="block px-3 py-2 rounded-md hover:bg-gray-100">
                    {locale === 'fa' ? 'خرید زمان' : 'Buy Time'}
                    </Link>
                </>
                )}

                {/* Admin Panel Link - Mobile */}
                {user?.is_admin && (
                <Link
                    href="/admin"
                    className="block px-3 py-2 rounded-md hover:bg-gray-100"
                >
                    {t('admin_panel') ?? 'Admin Panel'}
                </Link>
                )}

                {/* Mobile User Actions */}
                <div className="mt-2">
                {user ? (
                    <>
                    <span className="block px-3 py-2 text-gray-700">
                        {user.name ? user.name.split(' ')[0] : 'User'}
                    </span>
                    <button
                        onClick={handleLogout}
                        className="w-full text-left px-3 py-2 rounded-md hover:bg-gray-100 bg-primary text-white"
                    >
                        {t('logout') ?? 'Logout'}
                    </button>
                    </>
                ) : (
                    <div className="px-3 py-2">
                    <GoogleSignInButton
                        user={user}
                        onLoginSuccess={fetchUser}
                    >
                        {t('login') ?? 'Sign in by Google'}
                    </GoogleSignInButton>
                    </div>
                )}
                </div>
            </div>
            </div>
        )}
        </nav>
    );
}
            ```
        - **admin/**
            - UserDetails.js
                ```js
                /* src\components\admin\UserDetails.js */
// frontend/src/components/admin/UserDetails.js

'use client';

import { useEffect, useState } from 'react';

export default function UserDetails({ user }) {
    const [files, setFiles] = useState([]);
    const [activities, setActivities] = useState([]);
    const [amount, setAmount] = useState(0);
    const [loadingFiles, setLoadingFiles] = useState(true);
    const [loadingActivities, setLoadingActivities] = useState(true);
    const API_URL = process.env.NEXT_PUBLIC_API_URL;

    const fetchUserFiles = async () => {
        try {
        const res = await fetch(`${API_URL}/admin/users/${user.id}/files`, {
            credentials: 'include',
        });
        if (!res.ok) {
            throw new Error('Failed to fetch user files');
        }
        const data = await res.json();
        setFiles(data);
        setLoadingFiles(false);
        } catch (error) {
        console.error('Error fetching user files:', error);
        setLoadingFiles(false);
        }
    };

    const fetchUserActivities = async () => {
        try {
        const res = await fetch(`${API_URL}/admin/users/${user.id}/activities`, {
            credentials: 'include',
        });
        if (!res.ok) {
            throw new Error('Failed to fetch user activities');
        }
        const data = await res.json();
        setActivities(data);
        setLoadingActivities(false);
        } catch (error) {
        console.error('Error fetching user activities:', error);
        setLoadingActivities(false);
        }
    };

    useEffect(() => {
        fetchUserFiles();
        fetchUserActivities();
    }, [user]);

    const handleUpdateTime = async () => {
        if (isNaN(amount)) {
        alert('Please enter a valid number');
        return;
        }
        try {
        const res = await fetch(`${API_URL}/admin/users/${user.id}/time`, {
            method: 'PUT',
            credentials: 'include',
            headers: {
            'Content-Type': 'application/json',
            },
            body: JSON.stringify({ amount: parseFloat(amount) }),
        });
        if (!res.ok) {
            throw new Error('Failed to update user time');
        }
        const data = await res.json();
        alert(`User's remaining time updated to ${data.new_remaining_time} seconds`);
        setAmount(0);
        // Optionally, refresh user data
        } catch (error) {
        console.error('Error updating user time:', error);
        alert('Failed to update user time');
        }
    };

    return (
        <div className="bg-white shadow rounded p-4 w-full">
        <h2 className="text-2xl font-semibold mb-2">User Details</h2>
        <div className="flex items-center mb-4">
            <img src={user.picture} alt={user.name} className="w-16 h-16 rounded-full mr-4" />
            <div>
            <p className="text-xl font-medium">{user.name}</p>
            <p className="text-gray-500">{user.email}</p>
            <p className="mt-2">
                <strong>Remaining Time:</strong> {Math.floor(user.remaining_time / 60)} minutes
            </p>
            <p>
                <strong>Total Completed Duration:</strong> {user.total_completed_duration} seconds
            </p>
            </div>
        </div>

        {/* Update Remaining Time */}
        <div className="mb-6">
            <h3 className="text-xl font-semibold mb-2">Update Remaining Time</h3>
            <div className="flex items-center">
            <input
                type="number"
                value={amount}
                onChange={(e) => setAmount(e.target.value)}
                placeholder="Enter seconds to add/reduce"
                className="border p-2 mr-2 w-64"
            />
            <button
                onClick={handleUpdateTime}
                className="bg-green-500 text-white py-2 px-4 rounded"
            >
                Update Time
            </button>
            </div>
            <p className="text-sm text-gray-500 mt-1">
            Enter a positive number to add time or a negative number to reduce time.
            </p>
        </div>

        {/* Uploaded Files */}
        <div className="mb-6">
            <h3 className="text-xl font-semibold mb-2">Uploaded Files</h3>
            {loadingFiles ? (
            <p>Loading files...</p>
            ) : (
            <table className="min-w-full bg-white">
                <thead>
                <tr>
                    <th className="py-2 px-4 border">Filename</th>
                    <th className="py-2 px-4 border">Status</th>
                    <th className="py-2 px-4 border">Uploaded At</th>
                    <th className="py-2 px-4 border">Actions</th>
                </tr>
                </thead>
                <tbody>
                {files.map((file) => (
                    <tr key={file.id}>
                    <td className="py-2 px-4 border">{file.filename}</td>
                    <td className="py-2 px-4 border">{file.status}</td>
                    <td className="py-2 px-4 border">
                        {new Date(file.upload_time).toLocaleString()}
                    </td>
                    <td className="py-2 px-4 border">
                        {/* Implement actions like viewing transcription, deleting, etc. */}
                        <button className="bg-red-500 text-white py-1 px-3 rounded mr-2">
                        Delete
                        </button>
                        {file.transcription && (
                        <a
                            href={`data:text/plain;charset=utf-8,${encodeURIComponent(file.transcription)}`}
                            download={`${file.filename}_transcription.txt`}
                            className="bg-blue-500 text-white py-1 px-3 rounded"
                        >
                            Download
                        </a>
                        )}
                    </td>
                    </tr>
                ))}
                </tbody>
            </table>
            )}
        </div>

        {/* User Activities */}
        <div>
            <h3 className="text-xl font-semibold mb-2">User Activities</h3>
            {loadingActivities ? (
            <p>Loading activities...</p>
            ) : (
            <ul className="divide-y divide-gray-200">
                {activities.map((activity) => (
                <li key={activity.id} className="py-2">
                    <p className="text-sm">
                    <strong>{activity.activity_type.toUpperCase()}</strong> at{' '}
                    {new Date(activity.timestamp).toLocaleString()}
                    </p>
                    {activity.details && <p className="text-gray-600 text-sm">{activity.details}</p>}
                </li>
                ))}
            </ul>
            )}
        </div>
        </div>
    );
}

                ```
            - UserList.js
                ```js
                /* src\components\admin\UserList.js */
// frontend/src/components/admin/UserList.js

'use client';

import { useEffect, useState } from 'react';

export default function UserList({ onSelectUser }) {
    const [users, setUsers] = useState([]);
    const [loading, setLoading] = useState(true);
    const API_URL = process.env.NEXT_PUBLIC_API_URL;

    const fetchUsers = async () => {
        try {
        const res = await fetch(`${API_URL}/admin/users`, {
            credentials: 'include',
        });
        if (!res.ok) {
            throw new Error('Failed to fetch users');
        }
        const data = await res.json();
        setUsers(data);
        setLoading(false);
        } catch (error) {
        console.error('Error fetching users:', error);
        setLoading(false);
        }
    };

    useEffect(() => {
        fetchUsers();
    }, []);

    if (loading) {
        return <p>Loading users...</p>;
    }

    return (
        <div className="bg-white shadow rounded p-4">
        <h2 className="text-2xl font-semibold mb-2">Users</h2>
        <ul className="divide-y divide-gray-200">
            {users.map((user) => (
            <li
                key={user.id}
                className="py-2 cursor-pointer hover:bg-gray-50"
                onClick={() => onSelectUser(user)}
            >
                <div className="flex items-center">
                <img src={user.picture} alt={user.name} className="w-10 h-10 rounded-full mr-4" />
                <div>
                    <p className="text-lg font-medium">{user.name}</p>
                    <p className="text-sm text-gray-500">{user.email}</p>
                </div>
                </div>
            </li>
            ))}
        </ul>
        </div>
    );
}

                ```
    - **context/**
        - LanguageContext.js
            ```js
            /* src\context\LanguageContext.js */
/* frontend/src/context/LanguageContext.js */
'use client';

import React, { createContext, useState } from 'react';
import Cookies from 'js-cookie';

// Import locale messages synchronously
import enMessages from '../locales/en.json';
import faMessages from '../locales/fa.json';

const LanguageContext = createContext();

export function LanguageProvider({ children, initialLocale }) { // Accept initialLocale as a prop
  // Initialize state with the initialLocale passed from server
    const [locale, setLocale] = useState(initialLocale || 'fa');
    const [messages, setMessages] = useState(
        initialLocale === 'fa' ? faMessages : enMessages
    );

    const switchLanguage = (lang) => {
        setLocale(lang);
        Cookies.set('locale', lang, { expires: 365 }); // Store language preference

        // Update messages based on the selected language
        if (lang === 'fa') {
        setMessages(faMessages);
        } else {
        setMessages(enMessages);
        }
    };

    const t = (key, vars) => {
        let text = messages[key] || key;
        if (vars) {
        Object.keys(vars).forEach((varKey) => {
            text = text.replace(`{{${varKey}}}`, vars[varKey]);
        });
        }
        return text;
    };

    return (
        <LanguageContext.Provider value={{ locale, switchLanguage, t }}>
        {children}
        </LanguageContext.Provider>
    );
}

export default LanguageContext;

            ```
    - **lib/**
        - gtag.js
            ```js
            /* src\lib\gtag.js */
// frontend/src/lib/gtag.js

export const GA_TRACKING_ID = process.env.NEXT_PUBLIC_GA_MEASUREMENT_ID;

// Function to log page views
export const pageview = (url) => {
    window.gtag('config', GA_TRACKING_ID, {
        page_path: url,
    });
};

// Function to log specific events
export const event = ({ action, category, label, value }) => {
    window.gtag('event', action, {
        event_category: category,
        event_label: label,
        value: value,
    });
};

            ```
    - **locales/**
        - en.json
        - fa.json
- tailwind.config.js
    ```js
    /* tailwind.config.js */
/* frontend/tailwind.config.js */
/** @type {import('tailwindcss').Config} */
module.exports = {
  content: [
    "./src/components/**/*.{js,ts,jsx,tsx,mdx}",
    "./src/app/**/*.{js,ts,jsx,tsx,mdx}",
  ],
  theme: {
    extend: {
      // NEW color palette, leaning on parrot-inspired greens, plus accent colors
      colors: {
        primary: "#34D399",   // A bright green (Tailwind's emerald-400)
        secondary: "#10B981", // A deeper green (Tailwind's emerald-600)
        accent: "#F97316",    // A warm accent (Tailwind's orange-500)
        background: "#F9FAFB",
        foreground: "#1F2937",
      },
      // Update fonts to use Inter
      fontFamily: {
        sans: ["Inter", "sans-serif"],
        // keep farsi references if you like
        farsi: ["Vazir", "sans-serif"],
      },
    },
  },
  plugins: [],
};

    ```
    ```
- jsconfig.json
- next.config.mjs
- **node_modules/**
- package-lock.json
- package.json
- parrot-loader_20250426-194715.md
    ```md
    /* parrot-loader_20250426-194715.md */
# Project Tree Structure

- LICENSE.txt
    ```txt
    /* LICENSE.txt */
The MIT License (MIT)

Copyright (c) 2025 Dave Quah (https://codepen.io/Milleus/pen/WNewzPB)

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

    ```
- README.md
    ```md
    /* README.md */
# Parrot Loader

A Pen created on CodePen.

Original URL: [https://codepen.io/Milleus/pen/WNewzPB](https://codepen.io/Milleus/pen/WNewzPB).

Loader made with CSS animation.
    ```
- **src/**
    - index.html
        ```html
        /* src\index.html */
<div class="container">
  <div class="feather"></div>
  <div class="face-top"></div>
  <div class="face-bottom"></div>
  <div class="beak-top"></div>
  <div class="beak-bottom"></div>
</div>
        ```
    - style.scss
    ```
- postcss.config.mjs
- **src/**
    - **app/**
        - **admin/**
            - page.js
                ```js
                /* src\app\admin\page.js */
/* frontend/src/app/admin/page.js */
'use client';

import { useEffect, useState } from 'react';
import { useRouter } from 'next/navigation';

export default function AdminPanel() {
    const [user, setUser] = useState(null);
    const [isAdmin, setIsAdmin] = useState(false);
    const [users, setUsers] = useState([]);
    const [error, setError] = useState(null);
    const [currentPage, setCurrentPage] = useState(1);
    const [totalUsers, setTotalUsers] = useState(0);
    const [loading, setLoading] = useState(false);
    const router = useRouter();
    const API_URL = process.env.NEXT_PUBLIC_API_URL;
    const usersPerPage = 10;

    useEffect(() => {
        // Fetch the current user data
        const fetchUser = async () => {
            try {
                const res = await fetch(`${API_URL}/me`, {
                    credentials: 'include',
                });
                if (res.ok) {
                    const data = await res.json();
                    setUser(data);
                    if (data.is_admin) {
                        setIsAdmin(true);
                        fetchUsers();
                    } else {
                        setError('You are not authorized to access this page.');
                    }
                } else {
                    setError('Please log in to access the admin panel.');
                }
            } catch (err) {
                console.error('Error fetching user:', err);
                setError('An error occurred while fetching user data.');
            }
        };
        fetchUser();
    }, []);

    const fetchUsers = async (page = currentPage) => {
        try {
            setLoading(true);
            const skip = (page - 1) * usersPerPage;
            const res = await fetch(`${API_URL}/admin/users?limit=${usersPerPage}&skip=${skip}`, {
                credentials: 'include',
            });
            if (res.ok) {
                const data = await res.json();
                setUsers(data.users);
                setTotalUsers(data.total);
            } else {
                throw new Error('Failed to fetch users.');
            }
        } catch (err) {
            console.error('Error fetching users:', err);
            setError('An error occurred while fetching users.');
        } finally {
            setLoading(false);
        }
    };

    const updateUserTime = async (userId) => {
        const amountStr = prompt('Enter amount in minutes to add (positive) or reduce (negative):');
        const amount = parseFloat(amountStr);
        if (isNaN(amount)) {
            alert('Invalid amount');
            return;
        }
        try {
            const res = await fetch(`${API_URL}/admin/users/${userId}/time`, {
                method: 'PUT',
                credentials: 'include',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ amount }),
            });
            if (res.ok) {
                const data = await res.json();
                alert(`User ${userId} new remaining time: ${Math.floor(data.new_remaining_time)} minutes`);
                fetchUsers(currentPage);
            } else {
                const errData = await res.json();
                alert(`Error: ${errData.detail || 'An error occurred'}`);
            }
        } catch (err) {
            console.error('Error updating user time:', err);
            alert('An error occurred while updating user time.');
        }
    };

    const viewUserFiles = (userId) => {
        router.push(`/admin/users/${userId}/files`);
    };

    const viewUserActivities = (userId) => {
        router.push(`/admin/users/${userId}/activities`);
    };

    const handlePageChange = (newPage) => {
        if (newPage < 1 || newPage > Math.ceil(totalUsers / usersPerPage)) return;
        setCurrentPage(newPage);
        fetchUsers(newPage);
    };

    if (error) {
        return <div className="text-red-500 p-4">{error}</div>;
    }

    if (!user || !isAdmin) {
        return <div className="p-4">Loading...</div>;
    }

    return (
        <div className="p-4">
            <h1 className="text-2xl font-bold mb-4">Admin Panel</h1>
            {loading ? (
                <p>Loading users...</p>
            ) : (
                <table className="table-auto w-full mb-4">
                    <thead>
                        <tr className="bg-gray-200">
                            <th className="px-4 py-2">ID</th>
                            <th className="px-4 py-2">Email</th>
                            <th className="px-4 py-2">Name</th>
                            <th className="px-4 py-2">Remaining Time</th>
                            <th className="px-4 py-2">Expiration Date</th>
                            <th className="px-4 py-2">Successful Jobs</th>
                            <th className="px-4 py-2">Unsuccessful Jobs</th>
                            <th className="px-4 py-2">Total Transcription Duration</th>
                            <th className="px-4 py-2">Last Login</th>
                            <th className="px-4 py-2">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {users.map((userItem) => (
                            <tr key={userItem.id} className="border-b">
                                <td className="px-4 py-2">{userItem.id}</td>
                                <td className="px-4 py-2">{userItem.email}</td>
                                <td className="px-4 py-2">{userItem.name}</td>
                                <td className="px-4 py-2">{Math.floor(userItem.remaining_time)} minutes</td>
                                <td className="px-4 py-2">
                                    {userItem.expiration_date
                                        ? new Date(userItem.expiration_date).toLocaleDateString()
                                        : 'N/A'}
                                </td>
                                <td className="px-4 py-2">{userItem.successful_jobs}</td>
                                <td className="px-4 py-2">{userItem.failed_jobs}</td>
                                <td className="px-4 py-2">{Math.floor(userItem.total_used_time)} minutes</td>
                                <td className="px-4 py-2">
                                    {userItem.last_login ? new Date(userItem.last_login).toLocaleString() : 'Never'}
                                </td>
                                <td className="px-4 py-2">
                                    <button
                                        onClick={() => viewUserFiles(userItem.id)}
                                        className="bg-blue-500 text-white px-2 py-1 rounded mr-2"
                                    >
                                        View Files
                                    </button>
                                    <button
                                        onClick={() => viewUserActivities(userItem.id)}
                                        className="bg-green-500 text-white px-2 py-1 rounded mr-2"
                                    >
                                        View Activities
                                    </button>
                                    <button
                                        onClick={() => updateUserTime(userItem.id)}
                                        className="bg-yellow-500 text-white px-2 py-1 rounded"
                                    >
                                        Update Time
                                    </button>
                                </td>
                            </tr>
                        ))}
                    </tbody>
                </table>
            )}

            <div className="flex justify-center items-center mt-6 space-x-4">
                <button
                    onClick={() => handlePageChange(currentPage - 1)}
                    disabled={currentPage === 1}
                    className={`py-2 px-4 rounded ${
                        currentPage === 1 ? 'bg-gray-300 cursor-not-allowed' : 'bg-blue-500 text-white'
                    }`}
                >
                    Previous
                </button>
                <span>
                    Page {currentPage} of {Math.ceil(totalUsers / usersPerPage)}
                </span>
                <button
                    onClick={() => handlePageChange(currentPage + 1)}
                    disabled={currentPage === Math.ceil(totalUsers / usersPerPage)}
                    className={`py-2 px-4 rounded ${
                        currentPage === Math.ceil(totalUsers / usersPerPage)
                            ? 'bg-gray-300 cursor-not-allowed'
                            : 'bg-blue-500 text-white'
                    }`}
                >
                    Next
                </button>
            </div>
        </div>
    );
}
                ```
            - **users/**
                - **[userId]/**
        - **contact/**
            - page.js
                ```js
                /* src\app\contact\page.js */
/* frontend/src/app/contact/page.js */

'use client';

import { FaTelegramPlane, FaWhatsapp } from 'react-icons/fa';
import { PhoneIcon } from '@heroicons/react/24/solid';
import { useContext } from 'react';
import LanguageContext from '../../context/LanguageContext';

export default function Contact() {
    const { locale } = useContext(LanguageContext);
    const isRTL = locale === 'fa'; // Adjust based on your locale setup

    // Contact Methods Data
    const contactMethods = [
        {
            id: 'phone_whatsapp_telegram',
            label: locale === 'fa' ? 'تماس:' : 'Contact:',
            identifier: '+989335622283',
            icons: [
                <PhoneIcon key="phone" className="h-6 w-6 text-green-500" />,
                <FaWhatsapp key="whatsapp" className="h-6 w-6 text-green-500" />,
                <FaTelegramPlane key="telegram" className="h-6 w-6 text-blue-500" />,
            ],
            links: [
                'tel:+989335622283',
                'https://wa.me/989335622293',
                'https://t.me/tootty_com',
            ],
            ariaLabels: ['Phone', 'WhatsApp', 'Telegram'],
        },
    ];

    return (
        <div className="max-w-2xl mx-auto p-4 mt-20">
            <h1 className="text-3xl font-bold mb-6 text-center">
                {locale === 'fa' ? 'تماس با ما' : 'Contact Us'}
            </h1>

            <div className="space-y-6">
                {contactMethods.map((method) => (
                    <div key={method.id} className="text-center mb-4">
                        <p className="text-center" dir="auto">
                            <span className="font-bold">{method.label}</span> {method.identifier}
                        </p>
                        <div className="flex justify-center space-x-4 mt-2">
                            {method.icons.map((icon, index) => (
                                <a
                                    key={index}
                                    href={method.links[index]}
                                    {...(method.links[index].startsWith('http')
                                        ? { target: '_blank', rel: 'noopener noreferrer' }
                                        : {})}
                                    aria-label={method.ariaLabels[index]}
                                    className="hover:scale-110 transition-transform"
                                >
                                    {icon}
                                </a>
                            ))}
                        </div>
                    </div>
                ))}
            </div>
        </div>
    );
}
                ```
        - **dashboard/**
            - page.js
                ```js
                /* src\app\dashboard\page.js */
'use client';

import { useEffect, useState, useContext } from 'react';
import { useRouter } from 'next/navigation';
import FileUpload from '../../components/FileUpload';
import useSSE from '../hooks/useSSE';
import { EyeIcon, EyeSlashIcon } from '@heroicons/react/24/solid';
import LanguageContext from '../../context/LanguageContext';
import Link from 'next/link';
import ParrotLoader from '../../components/ParrotLoader';

export default function Home() {
    const [user, setUser] = useState(null);
    const [files, setFiles] = useState([]);
    const [currentPage, setCurrentPage] = useState(1);
    const [totalFiles, setTotalFiles] = useState(0);
    const [filesPerPage] = useState(10);
    const [loadingUser, setLoadingUser] = useState(true);
    const [loading, setLoading] = useState(false);
    const [expandedFiles, setExpandedFiles] = useState({});
    const { t } = useContext(LanguageContext);
    const router = useRouter();
    const API_URL = process.env.NEXT_PUBLIC_API_URL;

    useEffect(() => {
        const cachedUser = localStorage.getItem('tutty_user');
        if (cachedUser) {
            try {
                const parsed = JSON.parse(cachedUser);
                setUser(parsed);
                setLoadingUser(false);
            } catch (err) {
                console.warn('Corrupted user data in localStorage:', err);
            }
        }
        fetchUser();
    }, []);

    useEffect(() => {
        if (user) {
            fetchFiles(currentPage);
        }
    }, [user]);

    const { reconnect } = useSSE((data) => {
        setFiles((prevFiles) => {
            const fileExists = prevFiles.some((f) => f.id === data.file_id);
            if (fileExists) {
                return prevFiles.map((file) =>
                    file.id === data.file_id
                        ? { ...file, status: data.status, message: data.message }
                        : file
                );
            } else {
                fetchFiles(currentPage);
                return prevFiles;
            }
        });

        if (data.status === 'transcribed' || data.status === 'error') {
            fetchUser();
            fetchFiles(currentPage);
        }
    });

    async function fetchUser() {
        try {
            const res = await fetch(`${API_URL}/me`, { credentials: 'include' });
            if (res.ok) {
                const data = await res.json();
                setUser(data);
                localStorage.setItem('tutty_user', JSON.stringify(data));
            } else {
                setUser(null);
                localStorage.removeItem('tutty_user');
            }
        } catch (err) {
            console.error('Error fetching user:', err);
            setUser(null);
            localStorage.removeItem('tutty_user');
        } finally {
            setLoadingUser(false);
        }
    }

    async function fetchFiles(page = currentPage) {
        try {
            setLoading(true);
            const offset = (page - 1) * filesPerPage;
            const res = await fetch(
                `${API_URL}/files?limit=${filesPerPage}&offset=${offset}`,
                { credentials: 'include' }
            );
            if (res.ok) {
                const data = await res.json();
                setFiles(data.files);
                setTotalFiles(data.total);
            } else {
                setFiles([]);
            }
        } catch (err) {
            setFiles([]);
        } finally {
            setLoading(false);
        }
    }

    const handleDelete = async (fileId) => {
        try {
            const res = await fetch(`${API_URL}/files/${fileId}`, {
                method: 'DELETE',
                credentials: 'include',
            });
            if (res.ok) {
                fetchFiles(currentPage);
            }
        } catch (err) {
            // Silently handle error
        }
    };

    const handleDownload = (file) => {
        if (!file.transcription) return;
        const extension = file.output_format === 'srt' ? 'srt' : 'txt';
        const bom = '\uFEFF'; // UTF-8 Byte Order Mark
        const blob = new Blob([bom + file.transcription], { type: 'text/plain;charset=utf-8' });
        const link = document.createElement('a');
        link.download = `${file.filename}_transcription.${extension}`;
        link.href = window.URL.createObjectURL(blob);
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        window.URL.revokeObjectURL(link.href);
    };
    const handleCopy = async (transcription) => {
        if (!transcription) return;
        try {
            await navigator.clipboard.writeText(transcription);
            alert('Transcription copied to clipboard!');
        } catch (err) {
            alert('Failed to copy transcription.');
        }
    };

    const toggleTranscription = (fileId) => {
        setExpandedFiles((prev) => ({
            ...prev,
            [fileId]: !prev[fileId],
        }));
    };

    const totalPages = Math.ceil(totalFiles / filesPerPage);

    const handlePageChange = (newPage) => {
        if (newPage < 1 || newPage > totalPages) return;
        setCurrentPage(newPage);
        fetchFiles(newPage);
    };

    if (loadingUser) {
        return (
            <div className="flex flex-col items-center justify-center min-h-[50vh]">
                <ParrotLoader />
                <p className="mt-4 text-xl font-semibold">Loading your dashboard...</p>
            </div>
        );
    }

    if (!user) {
        return (
            <div className="text-center mt-20">
                <h1 className="text-4xl font-extrabold mb-4">
                    Welcome to <span className="text-primary">Tootty</span>
                </h1>
                <p className="text-lg mb-8">
                    Transcribe your media files easily and quickly.
                </p>
                <a
                    href={`${API_URL}/login`}
                    className="bg-primary hover:bg-secondary text-white py-3 px-6 rounded-md text-lg font-medium"
                >
                    Login with Google
                </a>
            </div>
        );
    }

    // If we have a user, show the real dashboard:
    return (
        <div className="max-w-7xl mx-auto p-4">
            <div className="flex flex-col md:flex-row md:items-center md:justify-between">
                <div>
                    <h2 className="text-2xl font-bold mb-2">{t('dashboard')}</h2>
                    <div className="flex flex-col items-start gap-2">
                        <p className="text-lg">
                            <strong>{t('remaining_time')}</strong>{' '}
                            {Math.floor(user.remaining_time)} {t('minutes')}
                            {user.expiration_date && (
                                <span className="text-sm text-gray-500 ml-2">
                                    (Expires on {new Date(user.expiration_date).toLocaleDateString()})
                                </span>
                            )}
                        </p>
                        {user.remaining_time === 0 && (
                            <p className="text-red-500 text-sm">
                                {user.expiration_date && new Date(user.expiration_date) < new Date()
                                    ? t('time_expired') || 'Your transcription time has expired. Please buy more time.'
                                    : t('time_used_up') || 'You have used all your transcription time. Please buy more time.'}
                            </p>
                        )}
                        <Link
                            href="/purchase"
                            className="inline-flex items-center px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md transition-colors"
                        >
                            {t('buy_more_time')}
                        </Link>
                    </div>
                </div>
                {user.picture && (
                    <img
                        src={user.picture}
                        alt="Profile"
                        className="rounded-full w-16 h-16 mt-4 md:mt-0 object-cover"
                    />
                )}
            </div>

            <FileUpload onUploadComplete={() => fetchFiles(currentPage)} />

            {loading ? (
                <p className="mt-8">Loading files...</p>
            ) : files.length > 0 ? (
                <div>
                    <h2 className="text-xl md:text-2xl font-bold mt-8">
                        {t('your_files')}
                    </h2>
                    <ul className="mt-4 space-y-4">
                        {files.map((file) => (
                            <li
                                key={file.id}
                                className="border rounded-md p-4 flex flex-col space-y-4 bg-white shadow"
                            >
                                <div className="flex flex-col md:flex-row md:justify-between md:items-center w-full">
                                    <div className="mb-4 md:mb-0 md:w-1/2">
                                        <p className="font-medium break-all text-foreground">
                                            {file.filename}
                                        </p>
                                        <p className="text-sm text-gray-500">
                                            Uploaded: {new Date(file.upload_time).toLocaleString()}
                                        </p>
                                        <p
                                            className={`mt-2 ${
                                                file.status === 'transcribed'
                                                    ? 'text-green-600'
                                                    : file.status === 'error'
                                                    ? 'text-red-600'
                                                    : 'text-yellow-600'
                                            }`}
                                        >
                                            Status: {file.status}
                                        </p>
                                        {file.message && (
                                            <p className="text-sm text-gray-500">{file.message}</p>
                                        )}
                                    </div>
                                    <div className="md:w-1/2 md:flex md:justify-end md:items-center space-x-2">
                                        {file.transcription && (
                                            <>
                                                <button
                                                    onClick={() => handleDownload(file)}
                                                    className="bg-secondary hover:bg-primary text-white py-1 px-3 rounded-md transition-colors"
                                                >
                                                    Download
                                                </button>
                                                <button
                                                    onClick={() => handleCopy(file.transcription)}
                                                    className="bg-accent hover:bg-primary text-white py-1 px-3 rounded-md transition-colors"
                                                >
                                                    Copy
                                                </button>
                                            </>
                                        )}
                                        <button
                                            onClick={() => handleDelete(file.id)}
                                            className="bg-red-500 hover:bg-red-600 text-white py-1 px-3 rounded-md transition-colors"
                                        >
                                            Delete
                                        </button>
                                        {file.transcription && (
                                            <button
                                                onClick={() => toggleTranscription(file.id)}
                                                className="bg-gray-500 hover:bg-gray-600 text-white py-1 px-3 rounded-md flex items-center transition-colors"
                                            >
                                                {expandedFiles[file.id] ? (
                                                    <>
                                                        <EyeSlashIcon className="w-5 h-5 mr-1" />
                                                        Hide
                                                    </>
                                                ) : (
                                                    <>
                                                        <EyeIcon className="w-5 h-5 mr-1" />
                                                        View
                                                    </>
                                                )}
                                            </button>
                                        )}
                                    </div>
                                </div>
                                {file.transcription && (
                                    <div
                                        className={`transition-all duration-300 overflow-y-auto ${
                                            expandedFiles[file.id]
                                                ? 'max-h-96 opacity-100 mt-4'
                                                : 'max-h-0 opacity-0'
                                        } bg-gray-100 p-4 rounded-md`}
                                    >
                                        <h3 className="font-semibold mb-2">Transcription:</h3>
                                        <p className="whitespace-pre-wrap text-gray-800">
                                            {file.transcription}
                                        </p>
                                    </div>
                                )}
                            </li>
                        ))}
                    </ul>
                    {totalPages > 1 && (
                        <div className="flex justify-center items-center mt-6 space-x-4">
                            <button
                                onClick={() => handlePageChange(currentPage - 1)}
                                disabled={currentPage === 1}
                                className={`py-2 px-4 rounded-md ${
                                    currentPage === 1
                                        ? 'bg-gray-300 cursor-not-allowed'
                                        : 'bg-primary text-white hover:bg-secondary'
                                }`}
                            >
                                Previous
                            </button>
                            <span>
                                Page {currentPage} of {totalPages}
                            </span>
                            <button
                                onClick={() => handlePageChange(currentPage + 1)}
                                disabled={currentPage === totalPages}
                                className={`py-2 px-4 rounded-md ${
                                    currentPage === totalPages
                                        ? 'bg-gray-300 cursor-not-allowed'
                                        : 'bg-primary text-white hover:bg-secondary'
                                }`}
                            >
                                Next
                            </button>
                        </div>
                    )}
                </div>
            ) : (
                <p className="mt-8">You have not uploaded any files yet.</p>
            )}
        </div>
    );
}
                ```
        - globals.css
            ```css
            /* src\app\globals.css */
/* frontend/src/app/globals.css */

@tailwind base;
@tailwind components;
@tailwind utilities;

/* Import fonts */
@import '@fontsource/poppins';
@import '@fontsource/merriweather';
@import 'vazir-font/dist/font-face.css'; /* Import Vazir Farsi font */
/* Import Inter from Google Fonts. 
   You could also import in the <head> with a <link>, but let's do it here for convenience. */
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
  @import 'vazir-font/dist/font-face.css'; /* Keep if you still want Vazir Farsi support */

/* Body and html styling */
html {
  scroll-behavior: smooth;
}

body {
  @apply bg-background text-foreground font-sans;
  margin: 0;
  padding: 0;
  font-family: 'Inter', sans-serif; /* Force body to Inter */
}

/* For Farsi content, selectively apply .font-farsi if needed */
.font-farsi {
  font-family: 'Vazir', sans-serif;
}

.font-english {
  font-family: 'Poppins', sans-serif;
}
/* Minimal resets for images */
img {
  max-width: 100%;
  height: auto;
}

/* Utility classes for button states, focus rings, etc. */
button:focus {
  @apply outline-none ring-2 ring-offset-2 ring-accent;
}

:root {
  --background: #FFFFFF;
  --foreground: #000000;
  --primary: #008080; /* Parrot-inspired teal */
  --secondary: #FFD700; /* Gold */
  --accent: #FF4500;   /* Orange-red */
}

@media (prefers-color-scheme: dark) {
  :root {
    --background: #1F2937;
    --foreground: #F9FAFB;
  }
}

a {
  @apply text-secondary hover:text-accent;
}

button {
  @apply focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent;
}

            ```
        - **hooks/**
            - useSSE.js
                ```js
                /* src\app\hooks\useSSE.js */
// src/app/hooks/useSSE.js
import { useEffect, useRef } from 'react';

export default function useSSE(onMessage) {
    const eventSourceRef = useRef(null);
    const retryTimeoutRef = useRef(null);
    const isConnectingRef = useRef(false);

    useEffect(() => {
        const API_URL = process.env.NEXT_PUBLIC_API_URL;
        let retryCount = 0;
        const MAX_RETRIES = 3;
        const RETRY_DELAY = 10000;

        function connect() {
            if (isConnectingRef.current) {
                return;
            }

            if (eventSourceRef.current) {
                eventSourceRef.current.close();
            }

            try {
                isConnectingRef.current = true;
                const eventSource = new EventSource(`${API_URL}/sse`, { withCredentials: true });
                eventSourceRef.current = eventSource;

                eventSource.onmessage = (event) => {
                    try {
                        const data = JSON.parse(event.data);
                        onMessage(data);
                        retryCount = 0;
                    } catch (error) {
                        // Silently handle message parsing errors
                    }
                };

                eventSource.onopen = () => {
                    isConnectingRef.current = false;
                    retryCount = 0;
                };

                eventSource.onerror = () => {
                    // Silently close the connection
                    eventSource.close();
                    isConnectingRef.current = false;

                    // Only retry if we haven't exceeded MAX_RETRIES
                    if (retryCount < MAX_RETRIES) {
                        retryCount++;
                        const delay = RETRY_DELAY * retryCount;
                        
                        if (retryTimeoutRef.current) {
                            clearTimeout(retryTimeoutRef.current);
                        }
                        
                        retryTimeoutRef.current = setTimeout(() => {
                            connect();
                        }, delay);
                    }
                };

            } catch (error) {
                // Silently handle connection errors
                isConnectingRef.current = false;
            }
        }

        // Handle visibility change silently
        const handleVisibilityChange = () => {
            if (document.visibilityState === 'visible') {
                connect();
            }
        };

        // Handle online/offline status silently
        const handleOnline = () => {
            connect();
        };

        const handleOffline = () => {
            if (eventSourceRef.current) {
                eventSourceRef.current.close();
            }
        };

        // Add event listeners
        document.addEventListener('visibilitychange', handleVisibilityChange);
        window.addEventListener('online', handleOnline);
        window.addEventListener('offline', handleOffline);

        // Initial connection only if online
        if (navigator.onLine) {
            connect();
        }

        // Cleanup function
        return () => {
            document.removeEventListener('visibilitychange', handleVisibilityChange);
            window.removeEventListener('online', handleOnline);
            window.removeEventListener('offline', handleOffline);
            
            if (retryTimeoutRef.current) {
                clearTimeout(retryTimeoutRef.current);
            }
            
            if (eventSourceRef.current) {
                eventSourceRef.current.close();
            }
        };
    }, [onMessage]);

    // Return a function to manually reconnect if needed
    return {
        reconnect: () => {
            if (eventSourceRef.current) {
                eventSourceRef.current.close();
            }
            if (retryTimeoutRef.current) {
                clearTimeout(retryTimeoutRef.current);
            }
            isConnectingRef.current = false;
            // Will trigger useEffect and reconnect
            window.dispatchEvent(new Event('online'));
        }
    };
}
                ```
        - layout.js
            ```js
            /* src\app\layout.js */
/* frontend/src/app/layout.js */
import './globals.css';
import { LanguageProvider } from '../context/LanguageContext';
import AppLayout from '../components/AppLayout';
import { cookies } from 'next/headers';
import Script from 'next/script';
import { GA_TRACKING_ID } from '../lib/gtag'; // Google Analytics tracking ID

export const metadata = {
  metadataBase: new URL('https://tootty.com'),
  title: 'Tootty AI',
  description: 'Transcribe and convert your media files (audio, video) to text or subtitles seamlessly with Tootty. Supports multiple languages including Persian, English, French, and more.',
  keywords: ['تبدیل صوت به متن','زیرنویس اتوماتیک','پیاده سازی','transcription', 'subtitle generation', 'media transcription', 'audio to text', 'farsi subtitle', 'speech recognition', 'Tootty', 'automatic transcription'],
  icons: '/favicon.ico',
  openGraph: {
    title: 'TooTTy - Advanced Transcription and Subtitle Generation',
    description: 'Automatically transcribe and generate subtitles from your media files. Fast, accurate, and multi-lingual.',
    url: 'https://tootty.com',
    siteName: 'Tootty',
    images: [
      {
        url: '/images/og-image.jpg',
        width: 800,
        height: 600,
        alt: 'Tutty Logo',
      },
    ],
    locale: 'en_US',
    type: 'website',
  },
  twitter: {
    card: 'summary_large_image',
    title: 'Tootty - Transcription Service',
    description: 'Transcribe your media files easily with Tootty.',
    images: ['/images/og-image.jpg'],
  },
  alternates: {
    canonical: 'https://tootty.com/',
  },
  robots: {
    index: true,
    follow: true,
  },
};

export default async function RootLayout({ children }) {
  const cookieStore = await cookies();
  const localeCookie = cookieStore.get('locale');
  const locale = localeCookie?.value || 'fa';

  return (
    <html lang={locale === 'fa' ? 'fa' : 'en'} dir={locale === 'fa' ? 'rtl' : 'ltr'}>
      <head>
        <meta name="author" content="Tootty Team" />
        <meta name="robots" content="index,follow" />
        <Script src="https://accounts.google.com/gsi/client" strategy="beforeInteractive" />
        {/* Google Analytics Script */}
        <Script
          src={`https://www.googletagmanager.com/gtag/js?id=${GA_TRACKING_ID}`}
          strategy="afterInteractive"
        />

        {/* Initialize Google Analytics */}
        <Script id="google-analytics" strategy="afterInteractive">
          {`
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', '${GA_TRACKING_ID}', {
              page_path: window.location.pathname,
            });
          `}
        </Script>
      </head>
      <body className="flex flex-col min-h-screen">
        <LanguageProvider initialLocale={locale}>
          <AppLayout>
            {/* MAIN CONTENT */}
            {children}
          </AppLayout>
        </LanguageProvider>
      </body>
    </html>
  );
}

            ```
        - page.js
            ```js
            /* src\app\page.js */
/* frontend/src/app/page.js */
'use client';

import { useEffect, useState, useContext } from 'react';
import { useRouter } from 'next/navigation';
import Image from 'next/image';
import LanguageContext from '../context/LanguageContext';
import GoogleSignInButton from '@/components/GoogleSignInButton';

export default function Home() {
    const [user, setUser] = useState(null);
    const router = useRouter();
    const API_URL = process.env.NEXT_PUBLIC_API_URL;
    const { t } = useContext(LanguageContext);

    useEffect(() => {
        fetchUser();
    }, []);

    const fetchUser = async () => {
        try {
            const res = await fetch(`${API_URL}/me`, {
                credentials: 'include',
            });
            if (res.ok) {
                const data = await res.json();
                setUser(data);
            } else {
                setUser(null);
            }
        } catch (err) {
            console.error('Error fetching user:', err);
        }
    };

    // Handler for login success
    const handleLoginSuccess = (userData) => {
        setUser(userData);
    };

    return (
        <div className="max-w-7xl mx-auto py-12 px-4">
            {/* Structured Data for SEO */}
            <script
                type="application/ld+json"
                dangerouslySetInnerHTML={{
                    __html: JSON.stringify({
                        "@context": "https://schema.org",
                        "@type": "WebSite",
                        name: "Tootty",
                        url: "https://tootty.com/",
                        description:
                            "Transcribe and convert media files (audio, video) automatically.",
                    }),
                }}
            />

            {/* Hero Section */}
            <section className="text-center mt-16 mb-20">
                <h1 className="text-4xl sm:text-5xl font-extrabold mb-4 text-primary">
                    {t('welcome_message')}
                </h1>
                <p className="text-xl text-gray-700 max-w-2xl mx-auto">
                    {t('transcribe_your_media')}
                </p>
            </section>

            {/* Features Section */}
            <section className="mt-10">
                <h2 className="text-3xl font-bold text-center mb-10 text-foreground">
                    {t('features')}
                </h2>
                <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div className="text-center p-6 rounded-lg bg-white shadow">
                        <Image
                            src="/images/feature1.svg"
                            alt="Accurate Transcriptions"
                            width={80}
                            height={80}
                            className="mx-auto mb-4"
                        />
                        <h3 className="text-lg font-semibold mb-2 text-foreground">
                            {t('accurate_transcribe')}
                        </h3>
                        <p className="text-gray-600">
                            {t('accurate_transcribe_text')}
                        </p>
                    </div>
                    <div className="text-center p-6 rounded-lg bg-white shadow">
                        <Image
                            src="/images/feature2.svg"
                            alt="Multiple Languages"
                            width={80}
                            height={80}
                            className="mx-auto mb-4"
                        />
                        <h3 className="text-lg font-semibold mb-2 text-foreground">
                            {t('multi_language')}
                        </h3>
                        <p className="text-gray-600">{t('multi_language_text')}</p>
                    </div>
                    <div className="text-center p-6 rounded-lg bg-white shadow">
                        <Image
                            src="/images/feature3.svg"
                            alt="Secure & Private"
                            width={80}
                            height={80}
                            className="mx-auto mb-4"
                        />
                        <h3 className="text-lg font-semibold mb-2 text-foreground">
                            {t('detect_speaker')}
                        </h3>
                        <p className="text-gray-600">{t('detect_speaker_text')}</p>
                    </div>
                </div>
            </section>

            {/* CTA Section */}
            <section className="text-center mt-16 mb-20">
                <h2 className="text-3xl font-bold text-primary mb-4">
                    {t('ready_to_get_started')}
                </h2>
                {!user && (
                    <p className="text-lg text-gray-700 mb-6">
                        {t('enjoy_seamless_transcription')}
                    </p>
                )}

                {/* Replace the “needs to be completed” part with the button below */}
                <GoogleSignInButton
                user={user}
                nextUrl="/dashboard"
                onLoginSuccess={handleLoginSuccess} // (optional) update local user state
                >
                    {t('start_here')}
                </GoogleSignInButton>
            </section>
        </div>
    );
}

            ```
        - **payment/**
            - **failed/**
                - page.js
                    ```js
                    /* src\app\payment\failed\page.js */
/* frontend/src/app/payment/failed/page.js */
"use client";

import { useEffect, useContext } from "react";
import { useRouter } from "next/navigation";
import LanguageContext from "../../../context/LanguageContext";

export default function PaymentFailedPage() {
    const router = useRouter();
    const { t } = useContext(LanguageContext);

    // Automatically redirect to /purchase after 5 seconds
    useEffect(() => {
        const timer = setTimeout(() => {
        router.push("/purchase");
        }, 5000);

        return () => clearTimeout(timer);
    }, [router]);

    return (
        <div className="max-w-2xl mx-auto p-6 text-center mt-20">
        <div className="bg-white rounded-lg shadow-md p-8">
            <div className="text-red-500 mb-4">
            <svg
                className="w-16 h-16 mx-auto"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
            >
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
            </svg>
            </div>
            <h1 className="text-2xl font-bold mb-4">{t("payment_failed")}</h1>
            <p className="text-gray-600 mb-4">{t("payment_failed_message")}</p>
            
            {/* Automatic redirect notice */}
            <p className="text-sm text-gray-500 mb-6">
            {t("redirecting_to_purchase_in_5_sec") ||
                "Redirecting to Purchase page in 5 seconds..."}
            </p>

            {/* Instant redirect button */}
            <button
            onClick={() => router.push("/purchase")}
            className="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-md"
            >
            {t("go_now") || "Go to Purchase Now"}
            </button>
        </div>
        </div>
    );
}

                    ```
            - **success/**
                - page.js
                    ```js
                    /* src\app\payment\success\page.js */
/* frontend/src/app/payment/success/page.js */
"use client";

import { useEffect, useContext } from "react";
import { useRouter } from "next/navigation";
import LanguageContext from "../../../context/LanguageContext";

export default function PaymentSuccessPage() {
    const router = useRouter();
    const { t } = useContext(LanguageContext);

    // Automatically redirect to /dashboard after 5 seconds
    useEffect(() => {
        const timer = setTimeout(() => {
        router.push("/dashboard");
        }, 5000);

        return () => clearTimeout(timer);
    }, [router]);

    return (
        <div className="max-w-2xl mx-auto p-6 text-center mt-20">
        <div className="bg-white rounded-lg shadow-md p-8">
            <div className="text-green-500 mb-4">
            <svg
                className="w-16 h-16 mx-auto"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
            >
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
            </svg>
            </div>
            <h1 className="text-2xl font-bold mb-4">{t("payment_successful")}</h1>
            <p className="text-gray-600 mb-4">{t("payment_success_message")}</p>
            
            {/* The automatic redirect notice */}
            <p className="text-sm text-gray-500 mb-6">
            {t("redirecting_to_dashboard_in_5_sec") ||
                "Redirecting to Dashboard in 5 seconds..."}
            </p>

            {/* Instant redirect button */}
            <button
            onClick={() => router.push("/dashboard")}
            className="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-md"
            >
            {t("go_now") || "Go to Dashboard Now"}
            </button>
        </div>
        </div>
    );
}

                    ```
        - **purchase/**
            - page.js
                ```js
                /* src\app\purchase\page.js */
"use client";

import { useState, useEffect, useContext } from "react";
import { useRouter } from "next/navigation";
import LanguageContext from "../../context/LanguageContext";

export default function PurchasePage() {
    const [hours, setHours] = useState(1);
    const [price, setPrice] = useState(0);
    const [loading, setLoading] = useState(false);
    const [error, setError] = useState(null);
    const router = useRouter();
    const { t, locale } = useContext(LanguageContext);
    const API_URL = process.env.NEXT_PUBLIC_API_URL;

    // Updated pricing function
    const calculatePrice = (hrs) => {
        if (hrs <= 4) {
            return hrs * 120000;
        } else if (hrs <= 9) {
            return hrs * 100000;
        } else {
            return hrs * 90000;
        }
    };

    function formatNumber(num, currentLocale) {
        const rawString = String(Math.round(num));
        let withCommas = rawString.replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        if (currentLocale === "fa") {
            const enToFa = {
                "0": "۰",
                "1": "۱",
                "2": "۲",
                "3": "۳",
                "4": "۴",
                "5": "۵",
                "6": "۶",
                "7": "۷",
                "8": "۸",
                "9": "۹",
            };
            withCommas = withCommas.replace(/[0-9]/g, (d) => enToFa[d]);
        }
        return withCommas;
    }

    useEffect(() => {
        setPrice(calculatePrice(hours));
    }, [hours]);

    const handleDecrement = () => {
        if (hours > 1) {
            setHours((prev) => prev - 1);
        }
    };

    const handleIncrement = () => {
        setHours((prev) => prev + 1);
    };

    const handleHoursChange = (e) => {
        const val = parseInt(e.target.value, 10);
        if (isNaN(val) || val < 1) {
            setHours(1);
        } else {
            setHours(val);
        }
    };

    const handlePurchase = async () => {
        try {
            setLoading(true);
            setError(null);
            const response = await fetch(`${API_URL}/payment/purchase`, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                credentials: "include",
                body: JSON.stringify({ hours: Number(hours) }),
            });
            const data = await response.json();
            if (!response.ok) {
                throw new Error(data.detail || "Failed to initiate payment");
            }
            if (data.success && data.payment_url) {
                window.location.href = data.payment_url;
            }
        } catch (err) {
            setError(err.message);
        } finally {
            setLoading(false);
        }
    };

    const finalPrice = Math.round(price * 1.1);
    const isPersian = locale === "fa";

    // Updated pricing plans
    const plans = [
        { key: "basic", price: 120000, hoursKey: "basic_plan_hours" },
        { key: "standard", price: 100000, hoursKey: "standard_plan_hours" },
        { key: "premium", price: 90000, hoursKey: "premium_plan_hours" },
    ];

    return (
        <div className={`max-w-4xl mx-auto px-4 py-8 ${isPersian ? "rtl" : ""}`}>
            {/* Hero / Intro Section */}
            <div className="text-center mb-10">
                <h1 className="text-3xl md:text-4xl font-bold text-primary mb-2">
                    {t("purchase_time")}
                </h1>
                <p className="text-gray-700">{t("enjoy_seamless_transcription")}</p>
            </div>

            {/* Pricing Information Cards */}
            <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                {plans.map((plan, index) => (
                    <div
                        key={plan.key}
                        className={`bg-white shadow-lg rounded-lg p-6 text-center transition-transform duration-300 hover:scale-105 ${
                            index === 1
                                ? "border-2 border-primary scale-105 relative overflow-hidden"
                                : ""
                        }`}
                    >
                        {index === 1 && (
                            <span className="absolute top-0 left-0 bg-primary text-white text-xs font-bold px-2 py-1 rounded-br-lg">
                                {t("most_popular") || "Most Popular"}
                            </span>
                        )}
                        <h2 className="text-xl font-semibold mb-2 text-foreground">
                            {t(`${plan.key}_plan`)}
                        </h2>
                        <p className="text-gray-500 mb-4">
                            {t(plan.hoursKey)}
                        </p>
                        <p className="text-sm text-gray-600 mb-2">
                            {locale === "fa" ? "در یک ماه" : "for a month"}
                        </p>
                        <p className="text-2xl font-bold text-gray-800 mb-4">
                            {formatNumber(plan.price, locale)}{" "}
                            <span className="text-sm">{t("toman_per_hour")}</span>
                        </p>
                        <p className="text-sm text-gray-500">
                            {locale === "fa" ? "بعلاوه 10% مالیات ارزش افزوده" : "plus 10% VAT"}
                        </p>
                    </div>
                ))}
            </div>

            {/* Contact Message */}
            <div className="text-center mb-8 text-gray-600">
                {locale === 'fa' ? (
                    <p>
                        مشاوره و خرید سازمانی{' '}
                        <a href="tel:09335622293" className="text-primary hover:underline">
                            09335622293
                        </a>
                    </p>
                ) : (
                    <p>
                        for more questions call or WhatsApp{' '}
                        <a href="tel:09335622293" className="text-primary hover:underline">
                            09335622293
                        </a>
                    </p>
                )}
            </div>

            {/* Hours Input with Stepper */}
            <div className="bg-white shadow-md rounded-lg p-6 mb-8">
                <h2 className="text-xl font-semibold mb-4 text-foreground">
                    {t("select_hours")}
                </h2>
                <div className="flex items-center space-x-3 max-w-xs">
                    <button
                        onClick={handleDecrement}
                        className="px-3 py-1 bg-gray-200 rounded text-2xl"
                    >
                        -
                    </button>
                    <input
                        type="number"
                        className="border border-gray-300 rounded-md w-24 p-2 text-center"
                        value={hours}
                        onChange={handleHoursChange}
                        min="1"
                        aria-label={t("select_hours")}
                    />
                    <button
                        onClick={handleIncrement}
                        className="px-3 py-1 bg-gray-200 rounded text-2xl"
                    >
                        +
                    </button>
                </div>
                <p className="text-sm text-gray-500 mt-2">
                    {t("type_any_hours") || "Enter any number of hours you need"}
                </p>
            </div>

            {/* Payment Summary Section */}
            <div className="bg-white shadow-md rounded-lg p-6 mb-8">
                <h2 className="text-xl font-semibold mb-4">{t("payment_summary")}</h2>
                <div className="flex justify-between mb-2">
                    <span className="text-lg">{t("total_price")}:</span>
                    <span className="text-lg font-semibold text-gray-800">
                        {formatNumber(price, locale)} {t("toman")}
                    </span>
                </div>
                <div className="flex justify-between mb-2">
                    <span className="text-lg">{t("final_price") || "Final Price"}:</span>
                    <span className="text-lg font-semibold text-gray-800">
                        {formatNumber(finalPrice, locale)} {t("toman")}
                    </span>
                </div>
                {error && (
                    <div className="mt-4 p-4 bg-red-100 text-red-700 rounded-md">
                        {error}
                    </div>
                )}
                <button
                    onClick={handlePurchase}
                    disabled={loading}
                    className={`mt-4 w-full md:w-auto inline-block py-3 px-6 rounded-md text-white font-semibold 
                        ${
                            loading
                                ? "bg-gray-400 cursor-not-allowed"
                                : "bg-primary hover:bg-secondary transition"
                        }`}
                >
                    {loading ? t("processing") : t("proceed_to_payment")}
                </button>
            </div>

            <div className="bg-gray-100 rounded-md p-4 text-sm text-gray-600">
                <p>
                    {t("disclaimer_text") ||
                        "Note: All prices subject to a 10% VAT. Payment is processed via Zarinpal gateway. If you have any questions, contact our support."}
                </p>
            </div>
        </div>
    );
}
                ```
        - sitemap.xml.js
            ```js
            /* src\app\sitemap.xml.js */
// frontend/src/app/sitemap.xml.js

import { NextResponse } from 'next/server';

export const dynamic = 'force-dynamic';

export async function GET() {
  // Normally you would fetch dynamic routes from your database
  // For demonstration, we assume a few static pages and dynamic routes.
    
    const baseUrl = 'https://tootty.com';
    
    // Static pages
    const pages = [
        '',
        'dashboard',
        'contact',
        'admin' // if admin panel is public or you want it indexed, otherwise omit
    ];
    
    // Construct sitemap entries
    const sitemapEntries = pages.map(page => `
        <url>
        <loc>${baseUrl}/${page}</loc>
        <lastmod>${new Date().toISOString()}</lastmod>
        <changefreq>weekly</changefreq>
        <priority>${page === '' ? '1.0' : '0.8'}</priority>
        </url>
    `).join('');

    const sitemap = `<?xml version="1.0" encoding="UTF-8"?>
    <urlset
        xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"
        xmlns:xhtml="http://www.w3.org/1999/xhtml"
    >
        ${sitemapEntries}
    </urlset>`;

    return new NextResponse(sitemap, {
        headers: {
        'Content-Type': 'application/xml',
        },
    });
}

            ```
    - **components/**
        - AppLayout.js
            ```js
            /* src\components\AppLayout.js */
/* frontend/src/components/AppLayout.js */

'use client';

import Navbar from './Navbar';
import Footer from './Footer';

export default function AppLayout({ children }) {
    return (
        <>
            <Navbar />
            <main className="flex-grow">{children}</main>
            <Footer />
        </>
    );
}

            ```
        - FileUpload.js
            ```js
            /* src\components\FileUpload.js */
/* frontend/src/components/FileUpload.js */

'use client';

import { useState, useContext } from 'react';
import LanguageContext from '../context/LanguageContext';
import Link from 'next/link';

export default function FileUpload({ onUploadComplete }) {
    const [file, setFile] = useState(null);
    const [message, setMessage] = useState('');
    const [uploading, setUploading] = useState(false);
    const API_URL = process.env.NEXT_PUBLIC_API_URL;
    const [outputFormat, setOutputFormat] = useState('txt');
    const [language, setLanguage] = useState('fa');
    const [diarize, setDiarize] = useState(false);
    const { t } = useContext(LanguageContext);

    const handleFileChange = (e) => {
        setFile(e.target.files[0]);
        setMessage('');
    };

    const handleSubmit = async (e) => {
        e.preventDefault();
        if (!file) {
            setMessage(t('please_select_a_file') || 'Please select a file');
            return;
        }

        setUploading(true);
        setMessage(t('uploading') || 'Uploading...');

        const formData = new FormData();
        formData.append('file', file);
        formData.append('output_format', outputFormat);
        formData.append('language', language);
        formData.append('tag_audio_events', 'false'); // Always set to false as per requirement
        formData.append('diarize', diarize.toString());

        try {
            const res = await fetch(`${API_URL}/upload`, {
                method: 'POST',
                credentials: 'include',
                body: formData,
            });

            setUploading(false);

            if (res.ok) {
                setMessage(t('upload_completed_transcription_in_progress') || 'Upload completed. Transcription in progress...');
                setFile(null);
                onUploadComplete && onUploadComplete();
            } else {
                const data = await res.json();
                if (data.detail === 'Insufficient transcription time. Please buy more time.') {
                    // Set message as a localized link to /purchase
                    setMessage(
                        <Link href="/purchase" className="text-primary underline">
                            {t('insufficient_transcription_time')}
                        </Link>
                    );
                } else {
                    setMessage(`${t('upload_failed') || 'Upload failed'}: ${data.detail || 'An error occurred'}`);
                }
            }
        } catch (err) {
            console.error('Error during upload:', err);
            setUploading(false);
            setMessage(`${t('upload_failed') || 'Upload failed'}: ${err.message || 'An error occurred'}`);
        }
    };

    return (
        <div className="p-4 bg-white border rounded-md mt-8 shadow-sm">
            <h2 className="text-xl md:text-2xl font-semibold mb-1 text-foreground">
                {t('upload_media') || 'Upload Media'}
            </h2>
            <p className="text-sm text-gray-500 mb-4">
                {t('media_file_limits') || 'Audio or video files with maximum 4 hours length and 250 MB size'}
            </p>
            <form onSubmit={handleSubmit} className="flex flex-col space-y-4">
                <input
                    type="file"
                    accept=".wav,.mp3,.mp4,.m4a,.flac,.aac,.ogg"
                    onChange={handleFileChange}
                    className="border p-2 rounded-md"
                    disabled={uploading}
                />
                
                <label className="flex flex-col text-foreground">
                    {t('language') || 'Language'}
                    <select
                        value={language}
                        onChange={(e) => setLanguage(e.target.value)}
                        className="border p-2 rounded-md mt-1"
                    >
                        <option value="fa">Persian</option>
                        <option value="en">English</option>
                        <option value="ar">Arabic</option>
                        <option value="tr">Turkish</option>
                        <option value="fr">French</option>
                        <option value="de">German</option>
                        <option value="ur">Urdu</option>
                        <option value="he">Hebrew</option>
                        <option value="es">Spanish</option>
                        <option value="pt">Portuguese</option>
                        <option value="ru">Russian</option>
                        <option value="cmn">Mandarin</option>
                        <option value="ja">Japanese</option>
                        <option value="hi">Hindi</option>
                        <option value="bn">Bengali</option>
                        <option value="id">Indonesian</option>
                        <option value="ko">Korean</option>
                        <option value="it">Italian</option>
                        <option value="nl">Dutch</option>
                        <option value="pl">Polish</option>
                        <option value="uk">Ukrainian</option>
                        <option value="ro">Romanian</option>
                        <option value="sv">Swedish</option>
                        <option value="el">Greek</option>
                        <option value="hu">Hungarian</option>
                        <option value="cs">Czech</option>
                        <option value="th">Thai</option>
                        <option value="ms">Malay</option>
                        <option value="vi">Vietnamese</option>
                        <option value="no">Norwegian</option>
                        <option value="fi">Finnish</option>
                        <option value="bg">Bulgarian</option>
                        <option value="sw">Swahili</option>
                        <option value="et">Estonian</option>
                        <option value="gl">Galician</option>
                        <option value="ga">Irish</option>
                        <option value="ug">Uyghur</option>
                    </select>
                </label>

                <label className="flex flex-col text-foreground">
                    {t('output_format') || 'Output Format'}
                    <select
                        value={outputFormat}
                        onChange={(e) => setOutputFormat(e.target.value)}
                        className="border p-2 rounded-md mt-1"
                    >
                        <option value="txt">Text (txt)</option>
                        <option value="srt">SubRip (srt)</option>
                        <option value="json">JSON</option>
                    </select>
                </label>

                <div className="flex flex-col space-y-2">
                    <label className="flex items-center space-x-2">
                        <input
                            type="checkbox"
                            checked={diarize}
                            onChange={(e) => setDiarize(e.target.checked)}
                            className="form-checkbox h-5 w-5 text-primary"
                        />
                        <span>{t('diarize') || 'Diarize (Speaker Identification)'}</span>
                    </label>
                </div>

                <button
                    type="submit"
                    className={`bg-primary text-white py-2 px-4 rounded-md ${
                        uploading ? 'opacity-50 cursor-not-allowed' : 'hover:bg-secondary'
                    }`}
                    disabled={uploading}
                >
                    {uploading ? (t('uploading') || 'Uploading...') : (t('upload') || 'Upload')}
                </button>
            </form>

            {message && (
                <p
                    className={`mt-4 ${
                        typeof message === 'object' ? 'text-red-600' : (
                            message.toLowerCase().includes('failed') ||
                            message.toLowerCase().includes('insufficient')
                                ? 'text-red-600'
                                : 'text-green-600'
                        )
                    }`}
                >
                    {message}
                </p>
            )}
        </div>
    );
}
            ```
        - Footer.js
            ```js
            /* src\components\Footer.js */
/* frontend\src\components\Footer.js */
import Link from 'next/link';
import Script from 'next/script';
import { useState, useEffect } from 'react';

export default function Footer() {
    // Whether we should load Enamad script at all
    const [loadEnamad, setLoadEnamad] = useState(false);
    // Whether the script actually finished loading
    const [enamadLoaded, setEnamadLoaded] = useState(false);

    useEffect(() => {
        // Lazy-load the Enamad script a few seconds after the component mounts
        const timer = setTimeout(() => {
        setLoadEnamad(true);
        }, 3000); // Adjust if needed
        return () => clearTimeout(timer);
    }, []);

    return (
        <footer className="bg-white border-t mt-8">
        <div className="max-w-7xl mx-auto py-6 px-4">
            {/* 
            We divide footer into three horizontal sections
            that stack into columns on small screens (md:flex-row).
            */}
            <div className="flex flex-col md:flex-row items-center">
            
            {/* 1) Left: Copyright & Powered by */}
            <div className="w-full md:w-1/3 flex justify-start items-center">
                <p className="text-sm text-gray-500">
                &copy; {new Date().getFullYear()}{' '}
                <span className="font-semibold text-primary">Tootty</span>.
                {' '}Powered by IRSDN.
                </p>
            </div>

            {/* 2) Center: Contact Link (make it bigger + centered) */}
            <div className="w-full md:w-1/3 flex justify-center my-4 md:my-0">
                <Link
                href="/contact"
                className="text-lg text-gray-600 hover:text-primary font-semibold"
                >
                Contact
                </Link>
            </div>

            {/* 3) Right: Enamad logo (lazy-loaded) */}
            <div className="w-full md:w-1/3 flex justify-end items-center">
                {loadEnamad ? (
                <div id="enamad-root">
                    <Script
                    id="enamad-script"
                    strategy="afterInteractive"
                    onLoad={() => setEnamadLoaded(true)}
                    onError={() => console.warn('Enamad script failed to load.')}
                    >
                    {`
                        var enamadHost = 'https://trustseal.enamad.ir';
                        var enamadParam = '?id=594666&Code=YY2Mg6gGdAGYLPpkfhWUk8xBU1Mqh29g';
                        document.getElementById('enamad-root').innerHTML = 
                        '<a target="_blank" href="' + enamadHost + enamadParam + '" ' +
                        'referrerPolicy="origin">' +
                        '<img src="' + enamadHost + '/logo.aspx' + enamadParam + '" ' +
                        'alt="نماد اعتماد الکترونیکی" style="cursor:pointer" ' +
                        'referrerPolicy="origin"/></a>';
                    `}
                    </Script>

                    {!enamadLoaded && (
                    <span className="text-xs text-gray-400">
                        Loading Enamad...
                    </span>
                    )}
                </div>
                ) : (
                <span className="text-xs text-gray-400">
                    Loading...
                </span>
                )}
            </div>

            </div>
        </div>
        </footer>
    );
}
            ```
        - GoogleSignInButton.js
            ```js
            /* src\components\GoogleSignInButton.js */
/* src/components/GoogleSignInButton.js */

/* 
    KEEPING PREVIOUS COMMENTS (EXAMPLE):
    Old approach was using "window.google.accounts.id" for a popup sign-in.
    This sometimes led to slow popups and AbortErrors if the user closed it.

    Now, we switch to a simpler redirect-based approach. We do not remove these 
    old comments, just comment out the old code so you can reference it later.
    */

    'use client';
    import { useRouter } from 'next/navigation';
    import { useEffect } from 'react';

    export default function GoogleSignInButton({
    children,
    // user,           // old approach used user
    nextUrl = '/dashboard',
    // onLoginSuccess, // old approach used onLoginSuccess
    }) {
    const router = useRouter();
    const API_URL = process.env.NEXT_PUBLIC_API_URL;

    // --------------------------------------------
    // Old popup-based approach (commented out)
    // --------------------------------------------
    /*
    useEffect(() => {
        if (typeof window !== 'undefined') {
        window.handleGoogleCredentialResponse = async (response) => {
            // ... old logic
        };
        if (window.google?.accounts?.id) {
            window.google.accounts.id.initialize({
            client_id: process.env.NEXT_PUBLIC_GOOGLE_CLIENT_ID,
            callback: (res) => window.handleGoogleCredentialResponse(res),
            });
            // setGoogleReady(true);
        }
        }
    }, [API_URL, nextUrl, onLoginSuccess, router]);
    
    const handleClickOld = async () => {
        if (user) {
        // if already logged in...
        router.push(nextUrl);
        } else {
        if (googleReady && window.google?.accounts?.id) {
            window.google.accounts.id.prompt();
        }
        }
    };
    */

    // --------------------------------------------
    // NEW: Redirect Flow
    // --------------------------------------------
    const handleClick = () => {
        // Simply redirect to /login/google (FastAPI route)
        // That route will redirect to Google’s OAuth page.
        window.location.href = `${API_URL}/login/google`;
    };

    return (
        <button
        onClick={handleClick}
        className="bg-primary text-white px-6 py-3 rounded-md font-semibold shadow hover:bg-secondary transition"
        >
        {children}
        </button>
    );
}

            ```
        - Navbar.js
            ```js
            /* src\components\Navbar.js */
/* frontend/src/components/Navbar.js */
'use client';
import Link from 'next/link';
import { useState, useEffect, useContext } from 'react';
import Image from 'next/image';
import LanguageContext from '../context/LanguageContext';
import GoogleSignInButton from './GoogleSignInButton';

export default function Navbar() {
  // State management for user data and mobile menu
    const [user, setUser] = useState(null);
    const [menuOpen, setMenuOpen] = useState(false);
    
    // Environment and context setup
    const API_URL = process.env.NEXT_PUBLIC_API_URL;
    const { locale, switchLanguage, t } = useContext(LanguageContext);

    // Helper function to check and update user state from localStorage
    const checkLocalStorage = () => {
        const cachedUser = localStorage.getItem('tutty_user');
        if (cachedUser) {
        try {
            const parsed = JSON.parse(cachedUser);
            setUser(parsed);
        } catch (err) {
            console.warn('Corrupted user data in localStorage:', err);
        }
        }
    };

    // Setup effect for user state management and event listeners
    useEffect(() => {
        // Initial state setup
        checkLocalStorage();
        fetchUser();
        
        // Event listener for login state changes
        const handleNavbarRefetch = () => {
        checkLocalStorage();
        fetchUser();
        };
        
        // Add event listener for cross-component communication
        window.addEventListener('navbarRefetch', handleNavbarRefetch);
        
        // Cleanup on component unmount
        return () => {
        window.removeEventListener('navbarRefetch', handleNavbarRefetch);
        };
    }, []);

    // Function to fetch latest user data from the server
    async function fetchUser() {
        try {
        const res = await fetch(`${API_URL}/me`, {
            credentials: 'include',
        });
        if (res.ok) {
            const data = await res.json();
            setUser(data);
            // Keep localStorage in sync with server data
            localStorage.setItem('tutty_user', JSON.stringify(data));
        } else {
            setUser(null);
            localStorage.removeItem('tutty_user');
        }
        } catch (err) {
        console.error('Error fetching user:', err);
        setUser(null);
        localStorage.removeItem('tutty_user');
        }
    }

    // Handle user logout process
    const handleLogout = async () => {
        try {
        const res = await fetch(`${API_URL}/logout`, {
            method: 'POST',
            credentials: 'include',
        });
        if (res.ok) {
            setUser(null);
            localStorage.removeItem('tutty_user');
            window.location.href = '/';
        } else {
            console.error('Logout failed:', res.statusText);
        }
        } catch (err) {
        console.error('Error logging out:', err);
        }
    };

    // Render user-specific content based on login state
    const renderUserActions = () => {
        if (user) {
        return (
            <>
            <span className="text-gray-700">
                {user.name ? user.name.split(' ')[0] : 'User'}
            </span>
            <button
                onClick={handleLogout}
                className="bg-primary hover:bg-secondary text-white px-3 py-2 rounded-md"
            >
                {t('logout') ?? 'Logout'}
            </button>
            </>
        );
        } else {
        return (
            <GoogleSignInButton
            user={user}
            onLoginSuccess={fetchUser}
            >
            {t('login') ?? 'Sign in by Google'}
            </GoogleSignInButton>
        );
        }
    };

    return (
        <nav className="bg-white border-b shadow-sm">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex justify-between items-center h-16">
            {/* Logo Section */}
            <Link href="/" className="flex items-center text-xl font-bold text-foreground">
            <Image
                src="/images/logo.png"
                alt="Tutty Logo"
                width={36}
                height={36}
                className="mr-2"
            />
            <span className="text-primary">Tootty</span>
            </Link>

            {/* Desktop Menu */}
            <div className="hidden md:flex items-center space-x-4">
            {/* Language Switcher */}
            <button
                onClick={() => switchLanguage('fa')}
                className={`px-3 py-2 rounded-md hover:bg-gray-100 transition ${
                locale === 'fa' ? 'bg-gray-100' : ''
                }`}
            >
                فارسی
            </button>
            <button
                onClick={() => switchLanguage('en')}
                className={`px-3 py-2 rounded-md hover:bg-gray-100 transition ${
                locale === 'en' ? 'bg-gray-100' : ''
                }`}
            >
                English
            </button>

            {/* Navigation Links for Logged-in Users */}
            {user && (
                <>
                <Link href="/dashboard" className="hover:text-primary transition px-3 py-2">
                    {t('dashboard') ?? 'Dashboard'}
                </Link>
                <Link href="/purchase" className="hover:text-primary transition px-3 py-2">
                    {locale === 'fa' ? 'خرید زمان' : 'Buy Time'}
                </Link>
                </>
            )}

            {/* Admin Panel Link */}
            {user?.is_admin && (
                <Link href="/admin" className="hover:text-primary transition px-3 py-2">
                {t('admin_panel') ?? 'Admin Panel'}
                </Link>
            )}
            </div>

            {/* Desktop User Actions */}
            <div className="hidden md:flex items-center space-x-4">
            {renderUserActions()}
            </div>

            {/* Mobile Menu Button */}
            <div className="md:hidden flex items-center">
            <button
                onClick={() => setMenuOpen(!menuOpen)}
                className="text-foreground focus:outline-none"
            >
                <svg className="w-6 h-6" fill="none" stroke="currentColor">
                {menuOpen ? (
                    <path
                    strokeLinecap="round"
                    strokeLinejoin="round"
                    strokeWidth={2}
                    d="M6 18L18 6M6 6l12 12"
                    />
                ) : (
                    <path
                    strokeLinecap="round"
                    strokeLinejoin="round"
                    strokeWidth={2}
                    d="M4 6h16M4 12h16M4 18h16"
                    />
                )}
                </svg>
            </button>
            </div>
        </div>

        {/* Mobile Menu Dropdown */}
        {menuOpen && (
            <div className="md:hidden bg-white border-t shadow-sm">
            <div className="px-2 pt-2 pb-3 space-y-1">
                {/* Language Switcher - Mobile */}
                <button
                onClick={() => switchLanguage('fa')}
                className={`block px-3 py-2 rounded-md ${
                    locale === 'fa' ? 'bg-gray-100' : ''
                }`}
                >
                فارسی
                </button>
                <button
                onClick={() => switchLanguage('en')}
                className={`block px-3 py-2 rounded-md ${
                    locale === 'en' ? 'bg-gray-100' : ''
                }`}
                >
                English
                </button>

                {/* Navigation Links - Mobile */}
                {user && (
                <>
                    <Link href="/dashboard" className="block px-3 py-2 rounded-md hover:bg-gray-100">
                    {t('dashboard') ?? 'Dashboard'}
                    </Link>
                    <Link href="/purchase" className="block px-3 py-2 rounded-md hover:bg-gray-100">
                    {locale === 'fa' ? 'خرید زمان' : 'Buy Time'}
                    </Link>
                </>
                )}

                {/* Admin Panel Link - Mobile */}
                {user?.is_admin && (
                <Link
                    href="/admin"
                    className="block px-3 py-2 rounded-md hover:bg-gray-100"
                >
                    {t('admin_panel') ?? 'Admin Panel'}
                </Link>
                )}

                {/* Mobile User Actions */}
                <div className="mt-2">
                {user ? (
                    <>
                    <span className="block px-3 py-2 text-gray-700">
                        {user.name ? user.name.split(' ')[0] : 'User'}
                    </span>
                    <button
                        onClick={handleLogout}
                        className="w-full text-left px-3 py-2 rounded-md hover:bg-gray-100 bg-primary text-white"
                    >
                        {t('logout') ?? 'Logout'}
                    </button>
                    </>
                ) : (
                    <div className="px-3 py-2">
                    <GoogleSignInButton
                        user={user}
                        onLoginSuccess={fetchUser}
                    >
                        {t('login') ?? 'Sign in by Google'}
                    </GoogleSignInButton>
                    </div>
                )}
                </div>
            </div>
            </div>
        )}
        </nav>
    );
}
            ```
        - ParrotLoader.css
            ```css
            /* src\components\ParrotLoader.css */
.container {
    position: relative;
    height: 10em;
    width: 10em;
    font-size: 1em; /* Default font size for scaling */
}

.container::before {
    content: "";
    position: absolute;
    top: 3.5em;
    left: 3.5em;
    height: 1.5em;
    width: 1.5em;
    background-color: #000000;
    border-radius: 50%;
    animation: slide 2s linear infinite;
    z-index: 4;
}

.feather {
    position: absolute;
    top: 0;
    left: 0;
    height: 10em;
    width: 5em;
    overflow: hidden;
    transform-origin: 100% 50%;
    animation: clockwise 2s linear infinite;
    z-index: 2;
}

.feather::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    height: 10em;
    width: 10em;
    background-color: #399918;
    border-radius: 50%;
}

.face-top {
    position: absolute;
    top: 2em;
    left: 2em;
    height: 6em;
    width: 3em;
    overflow: hidden;
    transform-origin: 100% 50%;
    animation: anti-clockwise 2s linear infinite;
    z-index: 3;
}

.face-top::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    height: 6em;
    width: 6em;
    background-color: #ffffff;
    border-radius: 50%;
}

.face-bottom {
    position: absolute;
    bottom: 2em;
    left: 2em;
    height: 3em;
    width: 3em;
    overflow: hidden;
    transform-origin: 100% 0%;
    animation: half-anti-clockwise 2s linear infinite;
    z-index: 4;
}

.face-bottom::before {
    content: "";
    position: absolute;
    bottom: 0;
    left: 0;
    height: 6em;
    width: 6em;
    background-color: #e2e1e2;
    border-radius: 50%;
}

.beak-top {
    position: absolute;
    top: 2em;
    right: 2em;
    height: 3em;
    width: 3em;
    overflow: hidden;
    transform-origin: 0% 100%;
    animation: half-anti-clockwise 2s linear infinite;
    z-index: 5;
}

.beak-top::before {
    content: "";
    position: absolute;
    top: 0;
    right: 0;
    height: 6em;
    width: 6em;
    background-color: #FF6600;
    border-radius: 50%;
}

.beak-bottom {
    position: absolute;
    bottom: 3.5em;
    right: 3.5em;
    height: 1.5em;
    width: 1.5em;
    overflow: hidden;
    transform-origin: 0% 0%;
    animation: half-clockwise 2s linear infinite;
    z-index: 1;
}

.beak-bottom::before {
    content: "";
    position: absolute;
    bottom: 0;
    right: 0;
    height: 4em;
    width: 4em;
    background-color: #e69d01;
    border-radius: 50%;
}

@keyframes slide {
    0% {
        transform: translate3d(0, 0, 0);
    }
    25% {
        transform: translate3d(1.5em, 0, 0);
    }
    50% {
        transform: translate3d(1.5em, 0, 0);
    }
    75% {
        transform: translate3d(0, 0, 0);
    }
    100% {
        transform: translate3d(0, 0, 0);
    }
}

@keyframes clockwise {
    0% {
        transform: rotate(0deg);
    }
    25% {
        transform: rotate(180deg);
    }
    50% {
        transform: rotate(180deg);
    }
    75% {
        transform: rotate(360deg);
    }
    100% {
        transform: rotate(360deg);
    }
}

@keyframes anti-clockwise {
    0% {
        transform: rotate(0deg);
    }
    25% {
        transform: rotate(-180deg);
    }
    50% {
        transform: rotate(-180deg);
    }
    75% {
        transform: rotate(-360deg);
    }
    100% {
        transform: rotate(-360deg);
    }
}

@keyframes half-clockwise {
    0% {
        transform: rotate(0deg);
    }
    25% {
        transform: rotate(90deg);
    }
    50% {
        transform: rotate(90deg);
    }
    75% {
        transform: rotate(0deg);
    }
    100% {
        transform: rotate(0deg);
    }
}

@keyframes half-anti-clockwise {
    0% {
        transform: rotate(0deg);
    }
    25% {
        transform: rotate(-90deg);
    }
    50% {
        transform: rotate(-90deg);
    }
    75% {
        transform: rotate(0deg);
    }
    100% {
        transform: rotate(0deg);
    }
}

/* Responsive Design */
@media (max-width: 768px) {
    .container {
        font-size: 0.8em;
    }
}

@media (max-width: 480px) {
    .container {
        font-size: 0.6em;
    }
}
            ```
        - ParrotLoader.js
            ```js
            /* src\components\ParrotLoader.js */
import React from 'react';
import './ParrotLoader.css';

export default function ParrotLoader() {
    return (
        <div className="container">
            <div className="feather"></div>
            <div className="face-top"></div>
            <div className="face-bottom"></div>
            <div className="beak-top"></div>
            <div className="beak-bottom"></div>
        </div>
    );
}
            ```
        - **admin/**
            - UserDetails.js
                ```js
                /* src\components\admin\UserDetails.js */
// frontend/src/components/admin/UserDetails.js

'use client';

import { useEffect, useState } from 'react';

export default function UserDetails({ user }) {
    const [files, setFiles] = useState([]);
    const [activities, setActivities] = useState([]);
    const [amount, setAmount] = useState(0);
    const [loadingFiles, setLoadingFiles] = useState(true);
    const [loadingActivities, setLoadingActivities] = useState(true);
    const API_URL = process.env.NEXT_PUBLIC_API_URL;

    const fetchUserFiles = async () => {
        try {
        const res = await fetch(`${API_URL}/admin/users/${user.id}/files`, {
            credentials: 'include',
        });
        if (!res.ok) {
            throw new Error('Failed to fetch user files');
        }
        const data = await res.json();
        setFiles(data);
        setLoadingFiles(false);
        } catch (error) {
        console.error('Error fetching user files:', error);
        setLoadingFiles(false);
        }
    };

    const fetchUserActivities = async () => {
        try {
        const res = await fetch(`${API_URL}/admin/users/${user.id}/activities`, {
            credentials: 'include',
        });
        if (!res.ok) {
            throw new Error('Failed to fetch user activities');
        }
        const data = await res.json();
        setActivities(data);
        setLoadingActivities(false);
        } catch (error) {
        console.error('Error fetching user activities:', error);
        setLoadingActivities(false);
        }
    };

    useEffect(() => {
        fetchUserFiles();
        fetchUserActivities();
    }, [user]);

    const handleUpdateTime = async () => {
        if (isNaN(amount)) {
        alert('Please enter a valid number');
        return;
        }
        try {
        const res = await fetch(`${API_URL}/admin/users/${user.id}/time`, {
            method: 'PUT',
            credentials: 'include',
            headers: {
            'Content-Type': 'application/json',
            },
            body: JSON.stringify({ amount: parseFloat(amount) }),
        });
        if (!res.ok) {
            throw new Error('Failed to update user time');
        }
        const data = await res.json();
        alert(`User's remaining time updated to ${data.new_remaining_time} seconds`);
        setAmount(0);
        // Optionally, refresh user data
        } catch (error) {
        console.error('Error updating user time:', error);
        alert('Failed to update user time');
        }
    };

    return (
        <div className="bg-white shadow rounded p-4 w-full">
        <h2 className="text-2xl font-semibold mb-2">User Details</h2>
        <div className="flex items-center mb-4">
            <img src={user.picture} alt={user.name} className="w-16 h-16 rounded-full mr-4" />
            <div>
            <p className="text-xl font-medium">{user.name}</p>
            <p className="text-gray-500">{user.email}</p>
            <p className="mt-2">
                <strong>Remaining Time:</strong> {Math.floor(user.remaining_time / 60)} minutes
            </p>
            <p>
                <strong>Total Completed Duration:</strong> {user.total_completed_duration} seconds
            </p>
            </div>
        </div>

        {/* Update Remaining Time */}
        <div className="mb-6">
            <h3 className="text-xl font-semibold mb-2">Update Remaining Time</h3>
            <div className="flex items-center">
            <input
                type="number"
                value={amount}
                onChange={(e) => setAmount(e.target.value)}
                placeholder="Enter seconds to add/reduce"
                className="border p-2 mr-2 w-64"
            />
            <button
                onClick={handleUpdateTime}
                className="bg-green-500 text-white py-2 px-4 rounded"
            >
                Update Time
            </button>
            </div>
            <p className="text-sm text-gray-500 mt-1">
            Enter a positive number to add time or a negative number to reduce time.
            </p>
        </div>

        {/* Uploaded Files */}
        <div className="mb-6">
            <h3 className="text-xl font-semibold mb-2">Uploaded Files</h3>
            {loadingFiles ? (
            <p>Loading files...</p>
            ) : (
            <table className="min-w-full bg-white">
                <thead>
                <tr>
                    <th className="py-2 px-4 border">Filename</th>
                    <th className="py-2 px-4 border">Status</th>
                    <th className="py-2 px-4 border">Uploaded At</th>
                    <th className="py-2 px-4 border">Actions</th>
                </tr>
                </thead>
                <tbody>
                {files.map((file) => (
                    <tr key={file.id}>
                    <td className="py-2 px-4 border">{file.filename}</td>
                    <td className="py-2 px-4 border">{file.status}</td>
                    <td className="py-2 px-4 border">
                        {new Date(file.upload_time).toLocaleString()}
                    </td>
                    <td className="py-2 px-4 border">
                        {/* Implement actions like viewing transcription, deleting, etc. */}
                        <button className="bg-red-500 text-white py-1 px-3 rounded mr-2">
                        Delete
                        </button>
                        {file.transcription && (
                        <a
                            href={`data:text/plain;charset=utf-8,${encodeURIComponent(file.transcription)}`}
                            download={`${file.filename}_transcription.txt`}
                            className="bg-blue-500 text-white py-1 px-3 rounded"
                        >
                            Download
                        </a>
                        )}
                    </td>
                    </tr>
                ))}
                </tbody>
            </table>
            )}
        </div>

        {/* User Activities */}
        <div>
            <h3 className="text-xl font-semibold mb-2">User Activities</h3>
            {loadingActivities ? (
            <p>Loading activities...</p>
            ) : (
            <ul className="divide-y divide-gray-200">
                {activities.map((activity) => (
                <li key={activity.id} className="py-2">
                    <p className="text-sm">
                    <strong>{activity.activity_type.toUpperCase()}</strong> at{' '}
                    {new Date(activity.timestamp).toLocaleString()}
                    </p>
                    {activity.details && <p className="text-gray-600 text-sm">{activity.details}</p>}
                </li>
                ))}
            </ul>
            )}
        </div>
        </div>
    );
}

                ```
            - UserList.js
                ```js
                /* src\components\admin\UserList.js */
// frontend/src/components/admin/UserList.js

'use client';

import { useEffect, useState } from 'react';

export default function UserList({ onSelectUser }) {
    const [users, setUsers] = useState([]);
    const [loading, setLoading] = useState(true);
    const API_URL = process.env.NEXT_PUBLIC_API_URL;

    const fetchUsers = async () => {
        try {
        const res = await fetch(`${API_URL}/admin/users`, {
            credentials: 'include',
        });
        if (!res.ok) {
            throw new Error('Failed to fetch users');
        }
        const data = await res.json();
        setUsers(data);
        setLoading(false);
        } catch (error) {
        console.error('Error fetching users:', error);
        setLoading(false);
        }
    };

    useEffect(() => {
        fetchUsers();
    }, []);

    if (loading) {
        return <p>Loading users...</p>;
    }

    return (
        <div className="bg-white shadow rounded p-4">
        <h2 className="text-2xl font-semibold mb-2">Users</h2>
        <ul className="divide-y divide-gray-200">
            {users.map((user) => (
            <li
                key={user.id}
                className="py-2 cursor-pointer hover:bg-gray-50"
                onClick={() => onSelectUser(user)}
            >
                <div className="flex items-center">
                <img src={user.picture} alt={user.name} className="w-10 h-10 rounded-full mr-4" />
                <div>
                    <p className="text-lg font-medium">{user.name}</p>
                    <p className="text-sm text-gray-500">{user.email}</p>
                </div>
                </div>
            </li>
            ))}
        </ul>
        </div>
    );
}

                ```
    - **context/**
        - LanguageContext.js
            ```js
            /* src\context\LanguageContext.js */
/* frontend/src/context/LanguageContext.js */
'use client';

import React, { createContext, useState } from 'react';
import Cookies from 'js-cookie';

// Import locale messages synchronously
import enMessages from '../locales/en.json';
import faMessages from '../locales/fa.json';

const LanguageContext = createContext();

export function LanguageProvider({ children, initialLocale }) { // Accept initialLocale as a prop
  // Initialize state with the initialLocale passed from server
    const [locale, setLocale] = useState(initialLocale || 'fa');
    const [messages, setMessages] = useState(
        initialLocale === 'fa' ? faMessages : enMessages
    );

    const switchLanguage = (lang) => {
        setLocale(lang);
        Cookies.set('locale', lang, { expires: 365 }); // Store language preference

        // Update messages based on the selected language
        if (lang === 'fa') {
        setMessages(faMessages);
        } else {
        setMessages(enMessages);
        }
    };

    const t = (key, vars) => {
        let text = messages[key] || key;
        if (vars) {
        Object.keys(vars).forEach((varKey) => {
            text = text.replace(`{{${varKey}}}`, vars[varKey]);
        });
        }
        return text;
    };

    return (
        <LanguageContext.Provider value={{ locale, switchLanguage, t }}>
        {children}
        </LanguageContext.Provider>
    );
}

export default LanguageContext;

            ```
    - **lib/**
        - gtag.js
            ```js
            /* src\lib\gtag.js */
// frontend/src/lib/gtag.js

export const GA_TRACKING_ID = process.env.NEXT_PUBLIC_GA_MEASUREMENT_ID;

// Function to log page views
export const pageview = (url) => {
    window.gtag('config', GA_TRACKING_ID, {
        page_path: url,
    });
};

// Function to log specific events
export const event = ({ action, category, label, value }) => {
    window.gtag('event', action, {
        event_category: category,
        event_label: label,
        value: value,
    });
};

            ```
    - **locales/**
        - en.json
        - fa.json
- tailwind.config.js
    ```js
    /* tailwind.config.js */
/* frontend/tailwind.config.js */
/** @type {import('tailwindcss').Config} */
module.exports = {
  content: [
    "./src/components/**/*.{js,ts,jsx,tsx,mdx}",
    "./src/app/**/*.{js,ts,jsx,tsx,mdx}",
  ],
  theme: {
    extend: {
      // NEW color palette, leaning on parrot-inspired greens, plus accent colors
      colors: {
        primary: "#34D399",   // A bright green (Tailwind's emerald-400)
        secondary: "#10B981", // A deeper green (Tailwind's emerald-600)
        accent: "#F97316",    // A warm accent (Tailwind's orange-500)
        background: "#F9FAFB",
        foreground: "#1F2937",
      },
      // Update fonts to use Inter
      fontFamily: {
        sans: ["Inter", "sans-serif"],
        // keep farsi references if you like
        farsi: ["Vazir", "sans-serif"],
      },
    },
  },
  plugins: [],
};

    ```